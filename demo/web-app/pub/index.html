<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <title>模块调度机制 - 前端实例</title> <link href="../r/core.css?f60113d5f42327bc6e98898019f61f4b" type="text/css" rel="stylesheet"/><style type="text/css">#module-box{min-height:500px;_height:500px;}</style> </head> <body> <!--[if gt IE 6]> <p>this is IE greater than 6</p> <![endif]--> <!--[if !IE]> --> <p>this is not IE</p> <!-- <![endif]--> <iframe src="/pub/test/a.html"></iframe> <p> <a href="/pub/test/a.html">aaaaa</a> <a href="/pub/test/b.html">aaaaa</a> </p> <iframe data-test-link="/pub/test/b.html"></iframe> <div class="g-doc"> <div class="g-hd"> <h1 class="m-logo">网易-杭研院-前端技术组-实例库</h1> <h2 class="m-title">模块调度机制</h2> </div> <div class="g-bd" id="module-box"></div> <div class="g-bd"> <div class="m-foot"> 如有任何问题，请联系：蔡剑飞(<a href="mailto:caijf@corp.netease.com">caijf@corp.netease.com</a>) </div> </div> <div class="g-ft"> <div class="m-foot"> &nbsp;&copy;&nbsp;网易-杭研院-前端技术组 </div> </div> </div> <div id="template-box" style="display:none;">  <textarea name="jst" id="ui-jst-0"> ui content </textarea> <textarea name="js">(function(){var u=NEJ.P,bp=NEJ.O,bw=NEJ.F,q=u("nej.e"),B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ui"),cJ;if(!!z.lS)return;z.lS=NEJ.C();cJ=z.lS.bC(bo.cH);cJ.df=function(){this.dy();q.mu();this.pG();this.lf()};cJ.cP=function(A){this.di(A);this.pH(A.clazz);this.pI(A.parent)};cJ.cS=function(){this.ds();this.lT();delete this.cY;q.fw(this.br);q.dC(this.br,this.hN);delete this.hN};cJ.pG=bw;cJ.lf=function(){if(!this.pM)this.pN();this.br=q.dg(this.pM);if(!this.br)this.br=q.cN("div",this.fS);q.dj(this.br,this.fS)};cJ.pN=bw;cJ.pH=function(bn){this.hN=bn||"";q.dj(this.br,this.hN)};cJ.pP=function(){if(!this.fS)return;q.dj(this.cY,this.fS+"-parent")};cJ.lT=function(){if(!this.fS)return;q.dC(this.cY,this.fS+"-parent")};cJ.rk=function(){return this.br};cJ.pI=function(bi){if(!this.br)return this;this.lT();if(B.cW(bi)){this.cY=bi(this.br)}else{this.cY=q.bk(bi);if(!!this.cY)this.cY.appendChild(this.br)}this.pP();return this};cJ.rj=function(){if(!this.cY||!this.br||this.br.parentNode==this.cY)return this;this.cY.appendChild(this.br);return this};cJ.pS=function(){q.fw(this.br);return this}})();
(function(){window.dispatcher.cr("/",null)})()</textarea> <textarea name="jst" id="m-jst-0"> <div class="w-tab"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box"></div> </textarea> <textarea name="css">.w-tab{border-bottom:1px solid #000;overflow:hidden;text-align:center;font-size:16px;zoom:1;}.w-tab .itm{display:block;float:left;width:100px;height:30px;line-height:30px;margin-right:10px;color:#000;background:#aaa;}.w-tab .itm:hover{text-decoration:none;}.w-tab .js-selected{background:#000;color:#fff;}.w-box{padding:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,fj,lP;z.hO=NEJ.C();fj=z.hO.bC(bo.bX,!0);lP=z.hO.cx;fj.cq=function(){this.dr=[{url:"/m/a/",name:"A",umi:"/m/a/a0/"},{url:"/m/b/",name:"B"},{url:"/m/c/",name:"C"},{url:"/m/d/",name:"D"}];this.br=q.cN("div");q.jn(this.br,"m-jst-0",{xlist:this.dr});var G=q.dz(this.br);this.eV.box=G[1];this.eG=q.gr(G[0],{clazz:"js-tag"});this.eG.gQ("onchange",this.fP.bh(this))};fj.fI=function(U){var bl=B.dH(this.dr,function(bP){return U.indexOf(bP.url)>=0});if(bl<0)return;this.eG.fL(bl);var bc=this.dr[0];if(U.indexOf(bc.url)>=0)bc.umi=U};fj.fP=function(g){var bc=this.dr[g.index];bg.dispatcher.fm(bc.umi||bc.url)};fj.dM=function(g){this.fI(g.href);lP.dM.apply(this,arguments)};fj.eA=function(g){this.fI(g.href)};bg.dispatcher.cr("/m",z.hO)})()</textarea>  </div> <script type="text/javascript">location.config = {"ver":{"index/a.a0.html":"71930279040558e929e692e3f485ec8d","index/a.a1.html":"e243694257b36750baed574ece4276aa","index/a.a2.html":"6f6a4b4ca6065780e771c1c2fcd9edce","index/a.html":"0b9c11b5cefdcf7c70769c278d6ed01c","index/b.b0.html":"75e8783fba4f0e5eb808c38af8cdad1a","index/b.b1.html":"b8f78ec59ed255d0c5cfd530141daf8f","index/b.b2.html":"3fc358a7b15d435a67f31d4579831b4b","index/b.html":"acde462c0b64880d395150138633f3aa","index/c.html":"2726aff6059f2874d082fe4a26caeebe","index/d.d0.html":"5526dd458c5362ae2a02d4231bd0c753","index/d.d1.html":"6ed66b73cf4be2b906b7ae55e1c3d8f8","index/d.d2.html":"3bd36f2eb2fd90bebe4c22012acc3c44","index/d.html":"60f682a4ce91a7338f0a12b0e8987eae","index/m.html":"36948c55450ec72938a64adf24ceeb4a","index/ui.html":"78d69fd9b33f1dcd4e85a47b27698596","index.html":"4c7eadb302417f0ef7e5998bf00bfb6e","simple.html":"f3c3792b2896ca277a36c93b1338073a","test/a.html":"7b52dd9dcc114f4d9f9a581a454368a9","test/b.html":"7b52dd9dcc114f4d9f9a581a454368a9"},"root":"./"};</script> <div style="display:none;" id="umi://index/a.html"><meta charset="utf-8"/> <textarea name="jst" id="a-jst-0"> <div class="w-tab2"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box2"></div> </textarea> <textarea name="css">.m-a .w-tab2{float:left;width:100px;margin-right:-100px;text-align:center;font-size:14px;}.m-a .w-tab2 .itm{display:block;height:30px;line-height:30px;margin-bottom:5px;color:#000;background:#ccc;}.m-a .w-tab2 .itm:hover{text-decoration:none;}.m-a .w-tab2 .js-selected{background:#888;color:#fff;font-weight:bold;}.m-a .w-box2{margin-left:100px;padding-left:10px;border-left:1px solid #888;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,eX,lo;z.iK=NEJ.C();eX=z.iK.bC(bo.bX,!0);lo=z.iK.cx;eX.cq=function(){this.dr=[{url:"/m/a/a0/",name:"A0"},{url:"/m/a/a1/",name:"A1"},{url:"/m/a/a2/",name:"A2"}];this.br=q.cN("div","m-a");q.jn(this.br,"a-jst-0",{xlist:this.dr});var G=q.dz(this.br);this.eV.box=G[1];this.eG=q.gr(G[0],{clazz:"js-tag"});this.eG.gQ("onchange",this.fP.bh(this))};eX.fI=function(U){var bl=B.dH(this.dr,function(bP){return bP.url===U});if(bl<0)return;this.eG.fL(bl)};eX.fP=function(g){bg.dispatcher.fm(this.dr[g.index].url)};eX.dM=function(g){this.fI(g.href);lo.dM.apply(this,arguments)};eX.eA=function(g){this.fI(g.href)};bg.dispatcher.cr("/m/a",z.iK)})()</textarea></div><div style="display:none;" id="umi://index/a.a0.html"><meta charset="utf-8"/> <textarea name="ntp" id="a0-ntp-0"> <div class="m-a0"> <input type="button" value="send message to C"/> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> </div> </textarea> <textarea name="css">.m-a0{min-height:500px;_height:500px;background:#f00;}.m-a0 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,iZ,oI;z.iW=NEJ.C();iZ=z.iW.bC(bo.bX,!0);oI=z.iW.cx;iZ.cq=function(){this.br=q.dg("a0-ntp-0");T.bG(this.br.getElementsByTagName("input")[0],"click",this.ep.bh(this))};iZ.ep=function(){bg.dispatcher.gS({to:"/m/c/",from:this.fo,data:"hello C! my name is a0."})};bg.dispatcher.cr("/m/a/a0/",z.iW)})()</textarea></div><div style="display:none;" id="umi://index/a.a1.html"><meta charset="utf-8"/> <textarea name="ntp" id="a1-ntp-0"> <div class="m-a1"> <input type="button" value="send message to C"/> <input type="button" value="send message to A0"/> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> </div> </textarea> <textarea name="css">.m-a1{min-height:500px;_height:500px;background:#fdc;}.m-a1 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,iV,oL;z.iT=NEJ.C();iV=z.iT.bC(bo.bX,!0);oL=z.iT.cx;iV.cq=function(){this.br=q.dg("a1-ntp-0");var G=this.br.getElementsByTagName("input");T.bG(G[0],"click",this.ep.bh(this,"/m/c/"));T.bG(G[1],"click",this.ep.bh(this,"/m/a/a0/"))};iV.ep=function(cL){bg.dispatcher.gS({to:cL,from:this.fo,data:"hello C! my name is a1."})};bg.dispatcher.cr("/m/a/a1/",z.iT)})()</textarea></div><div style="display:none;" id="umi://index/a.a2.html"><meta charset="utf-8"/> <textarea name="ntp" id="a2-ntp-0"> <div class="m-a2"> <input type="button" value="send message to C"/> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> </div> </textarea> <textarea name="css">.m-a2{min-height:500px;_height:500px;background:#aaa;}.m-a2 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,iP,oO;z.iO=NEJ.C();iP=z.iO.bC(bo.bX,!0);oO=z.iO.cx;iP.cq=function(){this.br=q.dg("a2-ntp-0");T.bG(this.br.getElementsByTagName("input")[0],"click",this.ep.bh(this))};iP.ep=function(){bg.dispatcher.gS({to:"/m/c/",from:this.fo,data:"hello C! my name is a2."})};bg.dispatcher.cr("/m/a/a2/",z.iO)})()</textarea></div><script src="../r/core.js?c0d50cb58994efda169163dc759af6c4" type="text/javascript"></script><script type="text/javascript">(function(){var u=NEJ.P,bp=NEJ.O,B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ut.p"),cF;if(!!z.eu)return;z.eu=NEJ.C();cF=z.eu.bC(bo.cH);cF.df=function(){this.dy();this.dU=[]};cF.cP=function(A){this.di(A);this.gK(A.parent);this.gW=A.name||"/";this.mb=A.data||{}};cF.cS=function(){var gn=function(S,bl,G){G.splice(bl,1);S.cc()};return function(){this.ds();delete this.mb;B.dI(this.dU,gn);this.gK(null)}}();cF.hD=function(S){return S instanceof z.eu};cF.pZ=function(cA){return B.dH(this.dU,cA)>=0};cF.fZ=function(){return this.gW};cF.db=function(){return this.mb};cF.dk=function(){var bi=this.dV(),I=this.fZ();if(!bi)return I;var fp=bi.fZ();if(fp!="/"&&I!="/")I="/"+I;return bi.dk()+I};cF.dV=function(){return this.cY};cF.dz=function(){return this.dU};cF.kb=function(I){var bl=B.dH(this.dU,function(S){return I==S.fZ()});return this.dU[bl]||null};cF.gK=function(bi){bi=this.hD(bi)?bi:null;if(bi==this.cY)return;!!bi?bi.jZ(this):this.cY.qi(this);this.cY=bi;return this};cF.jZ=function(cA){cA=this.hD(cA)?cA:null;if(!cA||this.pZ(cA))return;this.dU.push(cA);cA.gK(this);return this};cF.qi=function(cA){cA=this.hD(cA)?cA:null;var bl=B.dH(this.dU,cA);if(bl>=0){this.dU.splice(bl,1);cA.gK(null)}return cA}})();
(function(){var u=NEJ.P,bw=NEJ.F,B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ut.p");var ml=function(bV,U,jW){var S=bV,jW=jW||bw;if(U!="/"){B.bS(U.split("/"),function(I){var bj=jW(S,I);if(!bj)return!0;S=bj})}return S};z.er=function(){var fQ=function(bi,I){var I=I||"/",fp=bi.fZ();if(fp=="/"&&I=="/")return bi;return bi.kb(I)};return function(bV,U){return ml(bV,U,fQ)}}();z.qm=function(){var qn=function(bi,I){var fp=bi.fZ();if(!I&&fp=="/")return bi;var S=null;if(fp!="/"){S=bi.kb("/");if(!S){S=z.eu.bQ();bi.jZ(S)}}if(!!I){S=bi.kb(I);if(!S){S=z.eu.bQ({name:I});bi.jZ(S)}}return S};return function(bV,U){return ml(bV,U,qn)}}();z.qo=function(bV,cy,bH){if(!cy||!bH)return bV;var cy=cy.dk().split("/"),bH=bH.dk().split("/"),qq=B.cn(cy,function(bf,bl){if(bf!=bH[bl])return!0})||1,U=cy.splice(0,qq).join("/")||"/";return z.er(bV,U)};z.qr=function(bV,bD){var bm=[bV],S=bm.shift(),bD=bD||bw;while(!!S){bm.push.apply(bm,S.dz());bD(S);S=bm.shift()}return this};z.ga=function(S){return S instanceof z.eu};z.fb=function(bv){return bv instanceof bo.bX};z.jb=function(){var by=/^\/?\?(?=\/|$)/;return function(U){return by.test(U||"")}}();z.qw=function(){var by=/[\?#]/;return function(ba){var bm=(ba||"").trim().split(by),qx=bm[0]=="/"&&(bm[1]||"").indexOf("/")==0;return bm[0]+(qx?"?"+bm[1]:"")}}()})();
(function(){var u=NEJ.P,bp=NEJ.O,bg=u("nej.g"),q=u("nej.e"),bL=u("nej.j"),B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ut.p"),cs;if(!!z.gB)return;z.gB=NEJ.C();cs=z.gB.bC(bo.cH);cs.cP=function(A){this.di(A);this.cQ=A.root;this.eU=A.dispatcher;this.gz={}};cs.cS=function(){this.ds();delete this.cQ;delete this.gz};cs.iw=function(S){if(!z.ga(S))return!1;return!!S.db().stopped||this.iw(S.dV())};cs.iv=function(S){if(!z.ga(S))return;delete S.db().stopped;this.iv(S.dV())};cs.mB=function(bJ,cL){this.gy("onhide",bJ,cL)};cs.ip=function(bJ,cL){this.gy("onshow",bJ,cL);this.gd(bJ)};cs.mE=function(S){this.gy("onrefresh",S);this.gd(S)};cs.gy=function(N,bJ,cL){if(bJ==cL||!z.ga(bJ))return;if(N=="onhide")this.hE(bJ,N);this.gy(N,bJ.dV(),cL);if(N!="onhide")this.hE(bJ,N)};cs.gd=function(S){if(!z.ga(S))return!0;var Y=S.db(),kf=Y.action,bv=Y.module;if(!this.gd(S.dV())||!!kf&&B.da(bv))return!1;if(!!bv&&!!bv.bQ&&!!kf&&kf!="onhide"){if(this.iw(S))return;var A={umi:S.dk(),composite:Y.composite,dispatcher:this.eU};bv=bv.bQ(A);if(z.fb(bv)){Y.module=bv;this.hE(S,"onshow")}else{delete Y.module}}delete Y.action;return!0};cs.hE=function(){var qL=function(S){var bv;S=S.dV();while(!!S){bv=S.db().module;if(z.fb(bv)){return bv.pX()}S=S.dV()}return null};return function(S,I){if(!z.ga(S))return;var Y=S.db(),bv=Y.module,jU=I!="onhide";if(z.fb(bv)){if(jU&&this.iw(S))return;var g=!this.dB?Y.event:this.dB.db().event;if(!!g){g.umi=S.dk();g.data=qL(S)}var mJ=Y.xname||"onhide";if(I=="onshow"&&mJ!="onhide")I="onrefresh";if(I=="onrefresh"&&mJ=="onhide")I="onshow";Y.xname=I;bv.bA(I,g||{});if(jU&&!!g&&!!g.pos&&g.umi==g.target){q.mo(g.pos)}if(jU&&!!g){Y.stopped=g.stopped;delete g.stopped}}else if(!!bv){Y.action=I;if(I=="onshow"&&B.da(bv)){var j=q.bk("umi://"+bv);if(!!j){q.fg(j)}else{var bc=location.config||bp;bL.ky((bc.root||"")+bv,{version:(bc.ver||bp)[bv],onloaded:q.fg})}}}}}();cs.fU=function(U){return!!this.gz[U]};cs.qQ=function(U){this.gz[U]=!0;return this};cs.rh=function(U){delete this.gz[U];return this};cs.mM=function(U){if(this.fU(U))this.gd(z.er(this.cQ,U));return this};cs.iX=function(U){if(this.fU(U)){var S=z.er(this.cQ,U);this.iv(S);this.ip(S)}return this};cs.mO=function(U){if(this.fU(U)){this.mB(z.er(this.cQ,U))}return this}})();
(function(){var u=NEJ.P,bp=NEJ.O,bw=NEJ.F,q=u("nej.e"),z=u("nej.ut.p"),ea;if(!!z.iN)return;z.iN=NEJ.C();ea=z.iN.bC(z.gB);ea.cP=function(A){this.di(A);this.mR=!!A.classed};ea.cS=function(){this.ds();delete this.ew;delete this.dB};ea.qZ=function(g){if(!this.dB)return!0;var bv=this.dB.db().module;if(z.fb(bv))bv.bA("onbeforehide",g);return!g.stopped};ea.mT=function(){if(!this.dB)return;window.setTimeout(this.iX.bh(this,this.dB.dk()),0)};ea.iX=function(U){if(!this.fU(U))return this;var bH=z.er(this.cQ,U),Y=bH.db();if(!Y.module)return this;var cy=this.dB,g=Y.event,iU=bp;this.dB=bH;this.iv(bH);if(!!cy){iU=cy.db().event;g.referer=iU.href||""}if(cy==bH){this.mE(this.dB);return this}this.ew=z.qo(this.cQ,cy,bH);if(cy!=null){if(cy!=this.ew){if(this.mR)q.dC(document.body,iU.clazz);this.mB(cy,this.ew)}this.mE(this.ew)}else{this.ip(this.ew)}if(bH!=this.ew){if(this.mR)q.dj(document.body,g.clazz);this.ip(bH,this.ew)}return this};ea.mM=function(U){if(this.fU(U))this.gd(this.dB);return this};ea.mO=bw})();
(function(){var u=NEJ.P,T=u("nej.v"),B=u("nej.u"),fE=u("nej.p"),D=u("nej.h"),bo=u("nej.ut"),dc=/^[#?]+/,fC=/#(.*?)$/,dJ=window,ko=!history.pushState||fE.mh.android||!history.auto;var gX=function(ba,hH){dJ.history[!hH?"pushState":"replaceState"](null,document.title,ba)};var gu=function(){return location.parse(dJ.location.href)};gX=gX.bt(function(g){if(!ko)return;var E=g.args;g.stopped=!0;ba=E[0].replace(dc,"");!E[1]?dJ.location.hash=ba:dJ.location.replace("#"+ba)});gu=gu.bt(function(g){if(!ko)return;g.stopped=!0;var dX=fC.test(dJ.location.href)?RegExp.$1:"";g.value=location.parse(dX.replace(dc,""))});location.redirect=function(ba,hH){gX(ba,hH);return this};location.active=function(){var eN,ba,bR,jH,mr;var hF=function(hJ){if(!!jH){jH=!1;return}var g={oldValue:bR,newValue:gu()};if(!!location.ignored){location.ignored=!1}else{T.bA(location,"beforeurlchange",g);if(g.stopped){if(!!bR){jH=!0;gX(bR.href,!0)}return}}ba=dJ.location.href;bR=g.newValue;T.bA(location,"urlchange",bR);D.hM(bR.href)};var lR=function(){if(ba!=dJ.location.href)hF();eN=requestAnimationFrame(lR)};return function(el){if(!!mr)return this;mr=!0;dJ=el||window;if(ko&&"onhashchange"in window&&fE.dK.trident2){T.bG(dJ,"hashchange",hF);hF()}else if(!eN){eN=requestAnimationFrame(lR)}return this}}();location.parse=function(){var cz=/^https?:\/\/.*?\//i,dc=/[?#]/;return function(ba){var bj={href:ba};ba=(ba||"").replace(cz,"/").split(dc);var dn=1;if(ba[0]=="/"&&(ba[1]||"").indexOf("/")==0)dn=2;bj.path=ba.splice(0,dn).join("?");bj.query=B.li(ba.join("&"));return bj}}();location.same=function(ba){return gu().href==ba};bo.fF.bQ({element:location,event:["beforeurlchange","urlchange"]})})();
(function(){var u=NEJ.P,bp=NEJ.O,bw=NEJ.F,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),z=u("nej.ut"),cZ=u("nej.ut.p"),bO;if(!!z.gN)return;z.gN=NEJ.C();bO=z.gN.bC(z.cH);bO.df=function(){this.dy();var bE=+(new Date);this.fB="pb-"+bE;this.iI="pv-"+bE};bO.cP=function(A){this.iM={};this.ja=!!A.rest;this.cQ=cZ.eu.bQ();this.cd={m:{},mg:{},r:[],rr:{},al:{}};this.dG={};this.la(this.fB);this.dG[this.iI]=cZ.gB.bQ({root:this.cQ,dispatcher:this});this.hY([[location,"urlchange",this.jo.bh(this)]]);this.di(A);this.kT(A.rules);this.gT(A.modules)};bO.cS=function(){var gn=function(dh,W,bb){delete bb[W];dh.cc()};return function(){delete this.cd;this.cQ=this.cQ.cc();B.cn(this.dG,gn);this.ds()}}();bO.jB=function(U,W,bf){var eK=this.cd.m[U];if(!eK){eK={};this.cd.m[U]=eK}eK[W]=bf};bO.kx=function(U,W){var eK=this.cd.m[U];return!eK?"":eK[W]};bO.la=function(bN){if(!bN)return;var dh=this.dG[bN];if(!dh){dh=cZ.iN.bQ({root:this.cQ,dispatcher:this,classed:bN==this.fB});this.dG[bN]=dh}return dh};bO.qV=function(U,bN){var dh=this.la(bN);if(!dh){bN=cZ.jb(U)?this.iI:this.fB;dh=this.dG[bN]}dh.qQ(U);this.cd.mg[U]=bN};bO.qF=function(){var by=/\$\d/;return function(U,hJ){var bj;B.cn(this.cd.r,function(bc){B.cn(bc,function(bf,W){if(!!bf.test&&(bf.test(U)||bf.test(hJ))){bj=by.test(W)?U.replace(bf,W):W;return!0}if(bf===U||bf===hJ){bj=W;return!0}});return!!bj});return bj||U}}();bO.jo=function(){var fl=/(?:^\/+)|(?:\/+$)/gi,cz=/#(\$.*?)$/;var qD=function(U,S){var fd=S.dk(),U=U.replace(fd,"").replace(fl,"");return U.split("/")};var kZ=function(U,bb){var bf,bm=U.split("/");while(bm.length>0){if(!bm[bm.length-1]){bm.pop()}else{bm[bm.length-1]=""}bf=bb[bm.join("/")];if(!!bf)return bf}return""};return function(bR){if(bR.path.indexOf("$")==0)return;var oN=this.iM[bR.path];delete this.iM[bR.path];this.bA("onbeforechange",bR);var U=this.qF(bR.path,bR.href),bN=this.cd.mg[U];if(!bN&&this.ja)bN=kZ(U,this.cd.mg);if(!bN&&!cZ.jb(U)){U=this.cd.rr["404"];bN=this.cd.mg[U]}if(!bN&&this.ja)bN=kZ(U,this.cd.mg);if(!bN)return;var S=cZ.er(this.cQ,U),lj=null;if(this.ja)lj=qD(U,S);var cy=U;U=S.dk();S.db().event={target:U,source:cy,href:bR.href,param:bR.query,input:oN,prest:lj,clazz:this.kx(U,"clazz"),pos:cz.test(bR.href)?RegExp.$1:""};var hc=this.kx(cy,"title");if(!!hc)document.title=hc;this.dG[bN].iX(U)}}();bO.mX=function(){var pV=function(S){return!!q.cm(S,"href")};return function(g){var j=T.dp(g,pV);if(!!j){T.gL(g);this.fm(q.cm(j,"href"))}}}();bO.kT=function(){var pR=["404"];var pJ=function(bc,W){this.kT(W,bc)};var pv=function(hc,U){this.jB(U,"title",hc)};var oS=function(U,oP){this.cd.al[oP]=U};var lL=function(bc){if(!bc)return;this.cd.r.push(bc);B.bS(pR,function(W){if(!bc[W])return;this.cd.rr[W]=bc[W];delete bc[W]},this)};var gM={title:function(bc){B.cn(bc,pv,this)},rewrite:function(bc){if(!B.cG(bc)){lL.call(this,bc)}else{B.bS(bc,lL,this)}},alias:function(bc){B.cn(bc,oS,this)}};return function(W,bc){if(B.cG(W)){bc=W;W="rewrite"}else if(!B.da(W)){B.cn(W,pJ,this);return this}(gM[W]||bw).call(this,bc);return this}}();bO.gT=function(){var pY=function(bc,U){this.gT(U,bc)};var mk=function(bv){return!!bv&&!!bv.bC};return function(U,bc){if(!B.da(U)){B.cn(U,pY,this);return this}var Y=cZ.qm(this.cQ,U).db(),bv=Y.module;if(cZ.fb(bv)||mk(bv))return this;var bN=this.cd.mg[U],bv;if(B.da(bc)||mk(bc)){bv=bc}else{bc=bc||bp;bN=bc.gid;bv=bc.module;if(!!bc.title)this.jB(U,"title",bc.title);if(!!bc.clazz)this.jB(U,"clazz",bc.clazz);if(!!bc.composite)Y.composite=bc.composite}this.qV(U,bN);Y.module=bv;return this}}();bO.gS=function(){var hP=function(S,bY){var bv=S.db().module;if(cZ.fb(bv))bv.bA("onmessage",bY)};var gM=[hP,function(bH,bY){var bJ=bY.from;while(!!bH){if(bH.dk()!=bJ)hP(bH,bY);bH=bH.dV()}},function(bH,bY){var bJ=bY.from;cZ.qr(bH,function(S){if(S.dk()!=bJ)hP(S,bY)})}];return function(bY){var g=NEJ.X({},bY),bH=cZ.er(this.cQ,g.to);g.path=bH.dk();(gM[g.mode]||gM[0]).call(this,bH,g)}}();bO.pT=function(N,bY){var bY=NEJ.X({},bY);bY.type=N||"";this.bA((bY.from||"")+":"+bY.type,bY)};bO.pW=function(U,N,cf){U=this.cd.al[U]||U;this.pf((U||"")+":"+(N||""),cf)};bO.rX=function(U,N,cf){U=this.cd.al[U]||U;this.fu((U||"")+":"+(N||""),cf)};bO.iu=function(ba){return this.fm(ba)};bO.pS=function(U){var bN=this.cd.mg[U];if(bN==this.iI){this.dG[bN].mO(U)}return this};bO.fm=function(ba,A){A=A||bp;var U=cZ.qw(ba),bR=location.parse(ba);this.iM[bR.path]=A.input;if(cZ.jb(U)){this.jo(bR)}else{var dh=this.dG[this.fB],g={target:bR,umi:U};if(!!dh.qZ(g)){if(location.same(ba)&&!!A.force){this.jo(bR)}else{location.ignored=!!A.ignored;location.redirect(ba,!!A.replace)}}}return this};bO.mT=function(ba){if(!!ba){this.fm(ba,{replace:!0,force:!0})}else{this.dG[this.fB].mT()}};bO.rY=function(){this.hY([[document,"click",this.mX.bh(this)]]);return this};bO.mN=function(){location.active();return this};bO.cr=function(U,bv){U=this.cd.al[U]||U;if(!B.cG(U)){this.gT(U,bv);this.dG[this.cd.mg[U]].mM(U)}else{B.bS(U,function(W){this.cr(W,bv)},this)}return this};q.sa=function(A){window.dispatcher=z.gN.lN(A);q.fg((A||bp).tid||"template-box");T.bG(document,"templateready",function(){dispatcher.mN()});return window.dispatcher}})();
(function(){var u=NEJ.P,q=u("nej.e"),bo=u("nej.ut");window.dispatcher=bo.gN.lN({rules:{rewrite:{404:"/m/a/a0/","/m/a/a0/":"/"},title:{"/m/b/":"Module B","/m/c/":"Module C"}},modules:{"/":"index/ui.html","/m":"index/m.html","/m/a":"index/a.html","/m/b/":"index/b.html","/m/c/":"index/c.html","/m/d/":"index/d.html","/m/a/a0/":{module:"index/a.a0.html",title:"Module A-A0",clazz:"g-aa0"},"/m/a/a1/":{module:"index/a.a1.html",title:"Module A-A1",clazz:"g-aa1"},"/m/a/a2/":{module:"index/a.a2.html",title:"Module A-A2",clazz:"g-aa2"},"/?/b/b0/":"index/b.b0.html","/?/b/b1/":"index/b.b1.html","/?/b/b2/":"index/b.b2.html","/?/d/d0/":{module:"index/d.d0.html",title:"Module D-D0",gid:"d"},"/?/d/d1/":{module:"index/d.d1.html",title:"Module D-D1",gid:"d"},"/?/d/d2/":{module:"index/d.d2.html",title:"Module D-D2",gid:"d"}}});q.fg("template-box");dispatcher.mN()})()</script> </body> </html>