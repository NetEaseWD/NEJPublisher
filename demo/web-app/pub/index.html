<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <title>模块调度机制 - 前端实例</title> <link href="../r/core.css?f60113d5f42327bc6e98898019f61f4b" type="text/css" rel="stylesheet"/><style type="text/css">#module-box{min-height:500px;_height:500px;}</style> </head> <body> <div class="g-doc"> <div class="g-hd"> <h1 class="m-logo">网易-杭研院-前端技术组-实例库</h1> <h2 class="m-title">模块调度机制</h2> </div> <div class="g-bd" id="module-box"></div> <div class="g-bd"> <div class="m-foot"> 如有任何问题，请联系：蔡剑飞(<a href="mailto:caijf@corp.netease.com">caijf@corp.netease.com</a>) </div> </div> <div class="g-ft"> <div class="m-foot"> &nbsp;&copy;&nbsp;网易-杭研院-前端技术组 </div> </div> </div> <div id="template-box" style="display:none;">  <textarea name="jst" id="ui-jst-0"> ui content </textarea> <textarea name="js">(function(){var be=NEJ.P,cj=NEJ.O,cn=NEJ.F,bF=be("nej.e"),bL=be("nej.u"),bG=be("nej.ut"),bJ=be("nej.ui"),cd;if(!!bJ._$$Abstract)return;bJ._$$Abstract=NEJ.C();cd=bJ._$$Abstract._$extend(bG._$$Event);cd.__init=function(){this.__supInit();bF._$dumpCSSText();this.__initXGui();this.__initNode()};cd.__reset=function(bK){this.__supReset(bK);this.__doInitClass(bK.clazz);this._$appendTo(bK.parent)};cd.__destroy=function(){this.__supDestroy();this.__doDelParentClass();delete this.__parent;bF._$removeByEC(this.__body);bF._$delClassName(this.__body,this.__class);delete this.__class};cd.__initXGui=cn;cd.__initNode=function(){if(!this.__seed_html)this.__initNodeTemplate();this.__body=bF._$getNodeTemplate(this.__seed_html);if(!this.__body)this.__body=bF._$create("div",this.__seed_css);bF._$addClassName(this.__body,this.__seed_css)};cd.__initNodeTemplate=cn;cd.__doInitClass=function(ch){this.__class=ch||"";bF._$addClassName(this.__body,this.__class)};cd.__doAddParentClass=function(){if(!this.__seed_css)return;bF._$addClassName(this.__parent,this.__seed_css+"-parent")};cd.__doDelParentClass=function(){if(!this.__seed_css)return;bF._$delClassName(this.__parent,this.__seed_css+"-parent")};cd._$getBody=function(){return this.__body};cd._$appendTo=function(cf){if(!this.__body)return this;this.__doDelParentClass();if(bL._$isFunction(cf)){this.__parent=cf(this.__body)}else{this.__parent=bF._$get(cf);if(!!this.__parent)this.__parent.appendChild(this.__body)}this.__doAddParentClass();return this};cd._$show=function(){if(!this.__parent||!this.__body||this.__body.parentNode==this.__parent)return this;this.__parent.appendChild(this.__body);return this};cd._$hide=function(){bF._$removeByEC(this.__body);return this}})();
(function(){window.dispatcher._$loaded("/",null)})()</textarea> <textarea name="jst" id="m-jst-0"> <div class="w-tab"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box"></div> </textarea> <textarea name="css">.w-tab{border-bottom:1px solid #000;overflow:hidden;text-align:center;font-size:16px;zoom:1;}.w-tab .itm{display:block;float:left;width:100px;height:30px;line-height:30px;margin-right:10px;color:#000;background:#aaa;}.w-tab .itm:hover{text-decoration:none;}.w-tab .js-selected{background:#000;color:#fff;}.w-box{padding:10px 0;}</textarea><textarea name="js">(function(){var be=NEJ.P,bF=be("nej.e"),bT=be("nej.v"),bL=be("nej.u"),bG=be("dm.ut"),bJ=NEJ.P("dm.m"),ce=window,ep,ig;bJ._$$ModuleM=NEJ.C();ep=bJ._$$ModuleM._$extend(bG._$$Module,!0);ig=bJ._$$ModuleM._$supro;ep.__doBuild=function(){this.__xlist=[{url:"/m/a/",name:"A",umi:"/m/a/a0/"},{url:"/m/b/",name:"B"},{url:"/m/c/",name:"C"},{url:"/m/d/",name:"D"}];this.__body=bF._$create("div");bF._$renderHtmlTemplate(this.__body,"m-jst-0",{xlist:this.__xlist});var bO=bF._$getChildren(this.__body);this.__export.box=bO[1];this.__tab=bF._$tab(bO[0],{clazz:"js-tag"});this.__tab._$setEvent("onchange",this.__onTabChange._$bind(this))};ep.__doSyncTab=function(bS){var V=bL._$indexOf(this.__xlist,function(cC){return bS.indexOf(cC.url)>=0});if(V<0)return;this.__tab._$go(V);var bZ=this.__xlist[0];if(bS.indexOf(bZ.url)>=0)bZ.umi=bS};ep.__onTabChange=function(bH){var bZ=this.__xlist[bH.index];ce.dispatcher._$redirect(bZ.umi||bZ.url)};ep.__onShow=function(bH){this.__doSyncTab(bH.href);ig.__onShow.apply(this,arguments)};ep.__onRefresh=function(bH){this.__doSyncTab(bH.href)};ce.dispatcher._$loaded("/m",bJ._$$ModuleM)})()</textarea> <textarea name="jst" id="a-jst-0"> <div class="w-tab2"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box2"></div> </textarea> <textarea name="css">.m-a .w-tab2{float:left;width:100px;margin-right:-100px;text-align:center;font-size:14px;}.m-a .w-tab2 .itm{display:block;height:30px;line-height:30px;margin-bottom:5px;color:#000;background:#ccc;}.m-a .w-tab2 .itm:hover{text-decoration:none;}.m-a .w-tab2 .js-selected{background:#888;color:#fff;font-weight:bold;}.m-a .w-box2{margin-left:100px;padding-left:10px;border-left:1px solid #888;}</textarea><textarea name="js">(function(){var be=NEJ.P,bF=be("nej.e"),bT=be("nej.v"),bL=be("nej.u"),bG=be("dm.ut"),bJ=NEJ.P("dm.m"),ce=window,ey,hR;bJ._$$ModuleA=NEJ.C();ey=bJ._$$ModuleA._$extend(bG._$$Module,!0);hR=bJ._$$ModuleA._$supro;ey.__doBuild=function(){this.__xlist=[{url:"/m/a/a0/",name:"A0"},{url:"/m/a/a1/",name:"A1"},{url:"/m/a/a2/",name:"A2"}];this.__body=bF._$create("div","m-a");bF._$renderHtmlTemplate(this.__body,"a-jst-0",{xlist:this.__xlist});var bO=bF._$getChildren(this.__body);this.__export.box=bO[1];this.__tab=bF._$tab(bO[0],{clazz:"js-tag"});this.__tab._$setEvent("onchange",this.__onTabChange._$bind(this))};ey.__doSyncTab=function(bS){var V=bL._$indexOf(this.__xlist,function(cC){return cC.url===bS});if(V<0)return;this.__tab._$go(V)};ey.__onTabChange=function(bH){ce.dispatcher._$redirect(this.__xlist[bH.index].url)};ey.__onShow=function(bH){this.__doSyncTab(bH.href);hR.__onShow.apply(this,arguments)};ey.__onRefresh=function(bH){this.__doSyncTab(bH.href)};ce.dispatcher._$loaded("/m/a",bJ._$$ModuleA)})()</textarea>  </div> <script type="text/javascript">location.config = {"ver":{"index/a.a0.html":"ecafe5977c74f0b29c57fae315d7eb76","index/a.a1.html":"603c5f228c02558859edfb6f3a20973c","index/a.a2.html":"10b75b88c74d0acae78fa04cf3603e63","index/a.html":"8155a0b32e2a9eb4804ce28fbaf83973","index/b.b0.html":"7787fc305b724ef208e0b3e41e84ae0c","index/b.b1.html":"9672f4e39a1bd6ae802495160cdbd0a0","index/b.b2.html":"25fc799c873be4c82a3fedde3a6f6ab8","index/b.html":"33f2e18d01f8599811cf49bf0e3ddf53","index/c.html":"8abef1e91bdbc10417649c7bce63700d","index/d.d0.html":"4b191cab21800d638a871f6553810b3e","index/d.d1.html":"c9f1231774d23f89fac6d3f2ccffd775","index/d.d2.html":"bcff649d8af7490fde4795498fd848c7","index/d.html":"c17337745e1941aaeddddfd6c1987505","index/m.html":"af6c9d5428fe24d6d99f034bc96fd814","index/ui.html":"c17e2ce730ddc1bca1e959a4c1bcb7f3","index.html":"161d0e88a590649ab589e67217ecae15","simple.html":"f3c3792b2896ca277a36c93b1338073a","test/a.html":"7b52dd9dcc114f4d9f9a581a454368a9","test/b.html":"7b52dd9dcc114f4d9f9a581a454368a9"},"root":"./"};</script> <div style="display:none;" id="umi://index/a.a0.html"><meta charset="utf-8"/> <textarea name="ntp" id="a0-ntp-0"> <div class="m-a0"> <input type="button" value="send message to C"/> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> </div> </textarea> <textarea name="css">.m-a0{min-height:500px;_height:500px;background:#f00;}.m-a0 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var be=NEJ.P,bF=be("nej.e"),bT=be("nej.v"),bL=be("nej.u"),bG=be("dm.ut"),bJ=NEJ.P("dm.m"),ce=window,gV,jZ;bJ._$$ModuleA0=NEJ.C();gV=bJ._$$ModuleA0._$extend(bG._$$Module,!0);jZ=bJ._$$ModuleA0._$supro;gV.__doBuild=function(){this.__body=bF._$getNodeTemplate("a0-ntp-0");bT._$addEvent(this.__body.getElementsByTagName("input")[0],"click",this.__doSendMessage._$bind(this))};gV.__doSendMessage=function(){ce.dispatcher._$message({to:"/m/c/",from:this.__umi,data:"hello C! my name is a0."})};ce.dispatcher._$loaded("/m/a/a0/",bJ._$$ModuleA0)})()</textarea></div><div style="display:none;" id="umi://index/a.a1.html"><meta charset="utf-8"/> <textarea name="ntp" id="a1-ntp-0"> <div class="m-a1"> <input type="button" value="send message to C"/> <input type="button" value="send message to A0"/> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> </div> </textarea> <textarea name="css">.m-a1{min-height:500px;_height:500px;background:#fdc;}.m-a1 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var be=NEJ.P,bF=be("nej.e"),bT=be("nej.v"),bL=be("nej.u"),bG=be("dm.ut"),bJ=NEJ.P("dm.m"),ce=window,gQ,kb;bJ._$$ModuleA1=NEJ.C();gQ=bJ._$$ModuleA1._$extend(bG._$$Module,!0);kb=bJ._$$ModuleA1._$supro;gQ.__doBuild=function(){this.__body=bF._$getNodeTemplate("a1-ntp-0");var bO=this.__body.getElementsByTagName("input");bT._$addEvent(bO[0],"click",this.__doSendMessage._$bind(this,"/m/c/"));bT._$addEvent(bO[1],"click",this.__doSendMessage._$bind(this,"/m/a/a0/"))};gQ.__doSendMessage=function(dh){ce.dispatcher._$message({to:dh,from:this.__umi,data:"hello C! my name is a1."})};ce.dispatcher._$loaded("/m/a/a1/",bJ._$$ModuleA1)})()</textarea></div><div style="display:none;" id="umi://index/a.a2.html"><meta charset="utf-8"/> <textarea name="ntp" id="a2-ntp-0"> <div class="m-a2"> <input type="button" value="send message to C"/> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> </div> </textarea> <textarea name="css">.m-a2{min-height:500px;_height:500px;background:#aaa;}.m-a2 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var be=NEJ.P,bF=be("nej.e"),bT=be("nej.v"),bL=be("nej.u"),bG=be("dm.ut"),bJ=NEJ.P("dm.m"),ce=window,gN,kd;bJ._$$ModuleA2=NEJ.C();gN=bJ._$$ModuleA2._$extend(bG._$$Module,!0);kd=bJ._$$ModuleA2._$supro;gN.__doBuild=function(){this.__body=bF._$getNodeTemplate("a2-ntp-0");bT._$addEvent(this.__body.getElementsByTagName("input")[0],"click",this.__doSendMessage._$bind(this))};gN.__doSendMessage=function(){ce.dispatcher._$message({to:"/m/c/",from:this.__umi,data:"hello C! my name is a2."})};ce.dispatcher._$loaded("/m/a/a2/",bJ._$$ModuleA2)})()</textarea></div><script src="../r/core.js?7bf53659ed6b678e71d763d0a5aa9af0" type="text/javascript"></script><script type="text/javascript">(function(){var be=NEJ.P,cj=NEJ.O,bL=be("nej.u"),bG=be("nej.ut"),bJ=be("nej.ut.p"),de;if(!!bJ._$$Node)return;bJ._$$Node=NEJ.C();de=bJ._$$Node._$extend(bG._$$Event);de.__init=function(){this.__supInit();this.__children=[]};de.__reset=function(bK){this.__supReset(bK);this._$setParent(bK.parent);this.__name=bK.name||"/";this.__data=bK.data||{}};de.__destroy=function(){var eQ=function(bR,V,bO){bO.splice(V,1);bR._$recycle()};return function(){this.__supDestroy();delete this.__data;bL._$reverseEach(this.__children,eQ);this._$setParent(null)}}();de.__isNode=function(bR){return bR instanceof bJ._$$Node};de.__hasChild=function(cY){return bL._$indexOf(this.__children,cY)>=0};de._$getName=function(){return this.__name};de._$getData=function(){return this.__data};de._$getPath=function(){var cf=this._$getParent(),bP=this._$getName();if(!cf)return bP;var ew=cf._$getName();if(ew!="/"&&bP!="/")bP="/"+bP;return cf._$getPath()+bP};de._$getParent=function(){return this.__parent};de._$getChildren=function(){return this.__children};de._$getChildByName=function(bP){var V=bL._$indexOf(this.__children,function(bR){return bP==bR._$getName()});return this.__children[V]||null};de._$setParent=function(cf){cf=this.__isNode(cf)?cf:null;if(cf==this.__parent)return;!!cf?cf._$appendChild(this):this.__parent._$removeChild(this);this.__parent=cf;return this};de._$appendChild=function(cY){cY=this.__isNode(cY)?cY:null;if(!cY||this.__hasChild(cY))return;this.__children.push(cY);cY._$setParent(this);return this};de._$removeChild=function(cY){cY=this.__isNode(cY)?cY:null;var V=bL._$indexOf(this.__children,cY);if(V>=0){this.__children.splice(V,1);cY._$setParent(null)}return cY}})();
(function(){var be=NEJ.P,cn=NEJ.F,bL=be("nej.u"),bG=be("nej.ut"),bJ=be("nej.ut.p");var fe=function(cA,bS,gE){var bR=cA,gE=gE||cn;if(bS!="/"){bL._$forEach(bS.split("/"),function(bP){var ca=gE(bR,bP);if(!ca)return!0;bR=ca})}return bR};bJ._$getNodeByUMI=function(){var eY=function(cf,bP){var bP=bP||"/",ew=cf._$getName();if(ew=="/"&&bP=="/")return cf;return cf._$getChildByName(bP)};return function(cA,bS){return fe(cA,bS,eY)}}();bJ._$appendNodeByUMI=function(){var kG=function(cf,bP){var ew=cf._$getName();if(!bP&&ew=="/")return cf;var bR=null;if(ew!="/"){bR=cf._$getChildByName("/");if(!bR){bR=bJ._$$Node._$allocate();cf._$appendChild(bR)}}if(!!bP){bR=cf._$getChildByName(bP);if(!bR){bR=bJ._$$Node._$allocate({name:bP});cf._$appendChild(bR)}}return bR};return function(cA,bS){return fe(cA,bS,kG)}}();bJ._$getCommonRoot=function(cA,db,cu){if(!db||!cu)return cA;var db=db._$getPath().split("/"),cu=cu._$getPath().split("/"),kI=bL._$forIn(db,function(bY,V){if(bY!=cu[V])return!0})||1,bS=db.splice(0,kI).join("/")||"/";return bJ._$getNodeByUMI(cA,bS)};bJ._$breadthFirstSearch=function(cA,ci){var cg=[cA],bR=cg.shift(),ci=ci||cn;while(!!bR){cg.push.apply(cg,bR._$getChildren());ci(bR);bR=cg.shift()}return this};bJ._$isNode=function(bR){return bR instanceof bJ._$$Node};bJ._$isModule=function(co){return co instanceof bG._$$Module};bJ._$isUMIPrivate=function(){var S=/^\/?\?(?=\/|$)/;return function(bS){return S.test(bS||"")}}();bJ._$path2umi=function(){var S=/[\?#]/;return function(bW){var cg=(bW||"").trim().split(S),kK=cg[0]=="/"&&(cg[1]||"").indexOf("/")==0;return cg[0]+(kK?"?"+cg[1]:"")}}()})();
(function(){var be=NEJ.P,cj=NEJ.O,ce=be("nej.g"),bF=be("nej.e"),cw=be("nej.j"),bL=be("nej.u"),bG=be("nej.ut"),bJ=be("nej.ut.p"),cV;if(!!bJ._$$GroupManager)return;bJ._$$GroupManager=NEJ.C();cV=bJ._$$GroupManager._$extend(bG._$$Event);cV.__reset=function(bK){this.__supReset(bK);this.__root=bK.root;this.__dispatcher=bK.dispatcher;this.__mpool={}};cV.__destroy=function(){this.__supDestroy();delete this.__root;delete this.__mpool};cV.__isStopped=function(bR){if(!bJ._$isNode(bR))return!1;return!!bR._$getData().stopped||this.__isStopped(bR._$getParent())};cV.__doClearStopped=function(bR){if(!bJ._$isNode(bR))return;delete bR._$getData().stopped;this.__doClearStopped(bR._$getParent())};cV.__doModuleHide=function(cx,dh){this.__doModuleCheck("onhide",cx,dh)};cV.__doModuleShow=function(cx,dh){this.__doModuleCheck("onshow",cx,dh);this.__doModuleAction(cx)};cV.__doModuleRefresh=function(bR){this.__doModuleCheck("onrefresh",bR);this.__doModuleAction(bR)};cV.__doModuleCheck=function(bs,cx,dh){if(cx==dh||!bJ._$isNode(cx))return;if(bs=="onhide")this.__doModuleDispatch(cx,bs);this.__doModuleCheck(bs,cx._$getParent(),dh);if(bs!="onhide")this.__doModuleDispatch(cx,bs)};cV.__doModuleAction=function(bR){if(!bJ._$isNode(bR))return!0;var br=bR._$getData(),du=br.action,co=br.module;if(!this.__doModuleAction(bR._$getParent())||!!du&&bL._$isString(co))return!1;if(!!co&&!!co._$allocate&&!!du&&du!="onhide"){if(this.__isStopped(bR))return;var bK={umi:bR._$getPath(),composite:br.composite,dispatcher:this.__dispatcher};co=co._$allocate(bK);if(bJ._$isModule(co)){br.module=co;this.__doModuleDispatch(bR,"onshow")}else{delete br.module}}delete br.action;return!0};cV.__doModuleDispatch=function(){var kN=function(bR){var co;bR=bR._$getParent();while(!!bR){co=bR._$getData().module;if(bJ._$isModule(co)){return co._$getExportData()}bR=bR._$getParent()}return null};return function(bR,bP){if(!bJ._$isNode(bR))return;var br=bR._$getData(),co=br.module,gp=bP!="onhide";if(bJ._$isModule(co)){if(gp&&this.__isStopped(bR))return;var bH=!this.__source?br.event:this.__source._$getData().event;if(!!bH){bH.umi=bR._$getPath();bH.data=kN(bR)}var io=br.xname||"onhide";if(bP=="onshow"&&io!="onhide")bP="onrefresh";if(bP=="onrefresh"&&io=="onhide")bP="onshow";br.xname=bP;co._$dispatchEvent(bP,bH||{});if(gp&&!!bH&&!!bH.pos&&bH.umi==bH.target){bF._$scrollTo(bH.pos)}if(gp&&!!bH){br.stopped=bH.stopped;delete bH.stopped}}else if(!!co){br.action=bP;if(bP=="onshow"&&bL._$isString(co)){var bI=bF._$get("umi://"+co);if(!!bI){bF._$parseTemplate(bI)}else{var bZ=location.config||cj;cw._$loadHtml((bZ.root||"")+co,{version:(bZ.ver||cj)[co],onloaded:bF._$parseTemplate})}}}}}();cV._$hasUMI=function(bS){return!!this.__mpool[bS]};cV._$addUMI=function(bS){this.__mpool[bS]=!0;return this};cV._$delUMI=function(bS){delete this.__mpool[bS];return this};cV._$loadedUMI=function(bS){if(this._$hasUMI(bS))this.__doModuleAction(bJ._$getNodeByUMI(this.__root,bS));return this};cV._$dispatchUMI=function(bS){if(this._$hasUMI(bS)){var bR=bJ._$getNodeByUMI(this.__root,bS);this.__doClearStopped(bR);this.__doModuleShow(bR)}return this};cV._$hideUMI=function(bS){if(this._$hasUMI(bS)){this.__doModuleHide(bJ._$getNodeByUMI(this.__root,bS))}return this}})();
(function(){var be=NEJ.P,cj=NEJ.O,cn=NEJ.F,bF=be("nej.e"),bJ=be("nej.ut.p"),dP;if(!!bJ._$$SingleGroupManager)return;bJ._$$SingleGroupManager=NEJ.C();dP=bJ._$$SingleGroupManager._$extend(bJ._$$GroupManager);dP.__reset=function(bK){this.__supReset(bK);this.__classed=!!bK.classed};dP.__destroy=function(){this.__supDestroy();delete this.__cmroot;delete this.__source};dP._$exitable=function(bH){if(!this.__source)return!0;var co=this.__source._$getData().module;if(bJ._$isModule(co))co._$dispatchEvent("onbeforehide",bH);return!bH.stopped};dP._$refresh=function(){if(!this.__source)return;window.setTimeout(this._$dispatchUMI._$bind(this,this.__source._$getPath()),0)};dP._$dispatchUMI=function(bS){if(!this._$hasUMI(bS))return this;var cu=bJ._$getNodeByUMI(this.__root,bS),br=cu._$getData();if(!br.module)return this;var db=this.__source,bH=br.event,gi=cj;this.__source=cu;this.__doClearStopped(cu);if(!!db){gi=db._$getData().event;bH.referer=gi.href||""}if(db==cu){this.__doModuleRefresh(this.__source);return this}this.__cmroot=bJ._$getCommonRoot(this.__root,db,cu);if(db!=null){if(db!=this.__cmroot){if(this.__classed)bF._$delClassName(document.body,gi.clazz);this.__doModuleHide(db,this.__cmroot)}this.__doModuleRefresh(this.__cmroot)}else{this.__doModuleShow(this.__cmroot)}if(cu!=this.__cmroot){if(this.__classed)bF._$addClassName(document.body,bH.clazz);this.__doModuleShow(cu,this.__cmroot)}return this};dP._$loadedUMI=function(bS){if(this._$hasUMI(bS))this.__doModuleAction(this.__source);return this};dP._$hideUMI=cn})();
(function(){var be=NEJ.P,bT=be("nej.v"),bL=be("nej.u"),fn=be("nej.p"),bM=be("nej.h"),bG=be("nej.ut"),dq=/^[#?]+/,eV=/#(.*?)$/,dM=window,gf=!history.pushState||fn._$IS.android||!history.auto;var fu=function(bW,gc){dM.history[!gc?"pushState":"replaceState"](null,document.title,bW)};var ft=function(){return location.parse(dM.location.href)};fu=fu._$aop(function(bH){if(!gf)return;var bN=bH.args;bH.stopped=!0;bW=bN[0].replace(dq,"");!bN[1]?dM.location.hash=bW:dM.location.replace("#"+bW)});ft=ft._$aop(function(bH){if(!gf)return;bH.stopped=!0;var dN=eV.test(dM.location.href)?RegExp.$1:"";bH.value=location.parse(dN.replace(dq,""))});location.redirect=function(bW,gc){fu(bW,gc);return this};location.active=function(){var ek,bW,cD,gX,ir;var gJ=function(dx){if(!!gX){gX=!1;return}var bH={oldValue:cD,newValue:ft()};if(!!location.ignored){location.ignored=!1}else{bT._$dispatchEvent(location,"beforeurlchange",bH);if(bH.stopped){if(!!cD){gX=!0;fu(cD.href,!0)}return}}bW=dM.location.href;cD=bH.newValue;bT._$dispatchEvent(location,"urlchange",cD);bM.__pushHistory(cD.href)};var it=function(){if(bW!=dM.location.href)gJ();ek=requestAnimationFrame(it)};return function(dO){if(!!ir)return this;ir=!0;dM=dO||window;if(gf&&"onhashchange"in window&&fn._$NOT_PATCH.trident2){bT._$addEvent(dM,"hashchange",gJ);gJ()}else if(!ek){ek=requestAnimationFrame(it)}return this}}();location.parse=function(){var bz=/^https?:\/\/.*?\//i,dq=/[?#]/;return function(bW){var ca={href:bW};bW=(bW||"").replace(bz,"/").split(dq);var dw=1;if(bW[0]=="/"&&(bW[1]||"").indexOf("/")==0)dw=2;ca.path=bW.splice(0,dw).join("?");ca.query=bL._$query2object(bW.join("&"));return ca}}();location.same=function(bW){return ft().href==bW};bG._$$CustomEvent._$allocate({element:location,event:["beforeurlchange","urlchange"]})})();
(function(){var be=NEJ.P,cj=NEJ.O,cn=NEJ.F,bF=be("nej.e"),bT=be("nej.v"),bL=be("nej.u"),bJ=be("nej.ut"),dl=be("nej.ut.p"),cd;if(!!bJ._$$Dispatcher)return;bJ._$$Dispatcher=NEJ.C();cd=bJ._$$Dispatcher._$extend(bJ._$$Event);cd.__init=function(){this.__supInit();var bb=+(new Date);this.__pbseed="pb-"+bb;this.__pvseed="pv-"+bb};cd.__reset=function(bK){this.__dtmp={};this.__rest=!!bK.rest;this.__root=dl._$$Node._$allocate();this.__config={m:{},mg:{},r:[],rr:{},al:{},am:{}};this.__groups={};this.__doBuildGroup(this.__pbseed);this.__groups[this.__pvseed]=dl._$$GroupManager._$allocate({root:this.__root,dispatcher:this});this.__doInitDomEvent([[location,"urlchange",this.__onURLChange._$bind(this)]]);this.__supReset(bK);this._$rule(bK.rules);this._$regist(bK.modules)};cd.__destroy=function(){var eQ=function(dr,bU,bX){delete bX[bU];dr._$recycle()};return function(){delete this.__config;this.__root=this.__root._$recycle();bL._$forIn(this.__groups,eQ);this.__supDestroy()}}();cd.__setModuleConf=function(bS,bU,bY){var ed=this.__config.m[bS];if(!ed){ed={};this.__config.m[bS]=ed}ed[bU]=bY};cd.__getModuleConf=function(bS,bU){var ed=this.__config.m[bS];return!ed?"":ed[bU]};cd.__doBuildGroup=function(cB){if(!cB)return;var dr=this.__groups[cB];if(!dr){dr=dl._$$SingleGroupManager._$allocate({root:this.__root,dispatcher:this,classed:cB==this.__pbseed});this.__groups[cB]=dr}return dr};cd.__doAddUMI2Group=function(bS,cB){var dr=this.__doBuildGroup(cB);if(!dr){cB=dl._$isUMIPrivate(bS)?this.__pvseed:this.__pbseed;dr=this.__groups[cB]}dr._$addUMI(bS);this.__config.mg[bS]=cB};cd.__doRewriteUMI=function(){var S=/\$\d/;return function(bS,dx){var ca;bL._$forIn(this.__config.r,function(bZ){bL._$forIn(bZ,function(bY,bU){if(!!bY.test&&(bY.test(bS)||bY.test(dx))){ca=S.test(bU)?bS.replace(bY,bU):bU;return!0}if(bY===bS||bY===dx){ca=bU;return!0}});return!!ca});return ca||bS}}();cd.__onURLChange=function(){var er=/(?:^\/+)|(?:\/+$)/gi,bz=/#(\$.*?)$/;var lg=function(bS,bR){var eD=bR._$getPath(),bS=bS.replace(eD,"").replace(er,"");return bS.split("/")};var ix=function(bS,bX){var bY,cg=bS.split("/");while(cg.length>0){if(!cg[cg.length-1]){cg.pop()}else{cg[cg.length-1]=""}bY=bX[cg.join("/")];if(!!bY)return bY}return""};return function(cD){if(cD.path.indexOf("$")==0)return;var li=this.__dtmp[cD.path];delete this.__dtmp[cD.path];this._$dispatchEvent("onbeforechange",cD);var bS=this.__doRewriteUMI(cD.path,cD.href),cB=this.__config.mg[bS];if(!cB&&this.__rest)cB=ix(bS,this.__config.mg);if(!cB&&!dl._$isUMIPrivate(bS)){bS=this.__config.rr["404"];cB=this.__config.mg[bS]}if(!cB&&this.__rest)cB=ix(bS,this.__config.mg);if(!cB)return;var bR=dl._$getNodeByUMI(this.__root,bS),iy=null;if(this.__rest)iy=lg(bS,bR);var db=bS;bS=bR._$getPath();bR._$getData().event={target:bS,source:db,href:cD.href,param:cD.query,input:li,prest:iy,clazz:this.__getModuleConf(bS,"clazz"),pos:bz.test(cD.href)?RegExp.$1:""};var fG=this.__getModuleConf(db,"title");if(!!fG)document.title=fG;this.__groups[cB]._$dispatchUMI(bS)}}();cd.__onClickDelegate=function(){var iA=function(bW,dx){if(!bW)return;var eE=location.parse(bW);this._$dispatchEvent("onbeforechange",eE);var bS=this.__doRewriteUMI(eE.path,dx||eE.href);return this.__groups[this.__pbseed]._$hasUMI(bS)};var fe=function(bR){var bS=bF._$dataset(bR,"href");if(!!bS)return bS;var dx=bF._$attr(bR,"href");if(!!dx&&!bF._$dataset(bR,"notUmi")){var cg=dx.split("#");cg.shift();var bS=cg.join("#");if(iA.call(this,bS,dx)){return bS}if(iA.call(this,dx)){var eE=location.parse(dx);return eE.path+"?"+bL._$object2query(eE.query)}}};var ln=function(bR){return!!fe.call(this,bR)};return function(bH){var bI=bT._$getElement(bH,ln._$bind(this));if(!!bI){bT._$stopDefault(bH);this._$redirect(fe.call(this,bI))}}}();cd.__onActionDelegate=function(bH){var fp=this.__config.am,cP=fp[bH.type];if(!cP)return;var bI=bT._$getElement(bH,"d:resAction");if(!bI)return;var du=bF._$dataset(bI,"resAction"),ci=cP[du];if(!ci)return;var bK={action:du,target:bI,id:bF._$dataset(bI,"resId"),type:bF._$dataset(bI,"resType"),extra:bF._$dataset(bI,"resExtra")};this._$dispatchEvent("onbeforeaction",{event:bH,target:bI,result:bK});ci.call(this,bK)};cd._$rule=function(){var lp=["404"];var lq=function(bZ,bU){this._$rule(bU,bZ)};var lr=function(fG,bS){this.__setModuleConf(bS,"title",fG)};var ls=function(bS,lu){this.__config.al[lu]=bS};var iD=function(bZ){if(!bZ)return;this.__config.r.push(bZ);bL._$forEach(lp,function(bU){if(!bZ[bU])return;this.__config.rr[bU]=bZ[bU];delete bZ[bU]},this)};var lw=function(du,bP){var fp=this.__config.am;var bH="click",ci=du,bP=(bP||"").toLowerCase();if(bL._$isObject(du)){bH=du.event||bH;ci=du.value}if(bL._$isString(ci)){ci=function(bS,bK){this._$redirect(bS,{force:!0,input:bK})}._$bind(this,ci)}else if(bL._$isFunction(ci)){ci=ci._$aop(null,function(bH){var ca=bH.value;if(bL._$isString(ca)){this._$redirect(ca,{force:!0,input:bH.args[0]})}}._$bind(this))}if(bL._$isFunction(ci)){if(!fp[bH]){this.__doInitDomEvent([[document,bH,this.__onActionDelegate._$bind(this)]]);fp[bH]={}}fp[bH][bP]=ci}};var dF={title:function(bZ){bL._$forIn(bZ,lr,this)},rewrite:function(bZ){if(!bL._$isArray(bZ)){iD.call(this,bZ)}else{bL._$forEach(bZ,iD,this)}},alias:function(bZ){bL._$forIn(bZ,ls,this)},action:function(bZ){bL._$forIn(bZ,lw,this)}};return function(bU,bZ){if(bL._$isArray(bU)){bZ=bU;bU="rewrite"}else if(!bL._$isString(bU)){bL._$forIn(bU,lq,this);return this}(dF[bU]||cn).call(this,bZ);return this}}();cd._$regist=function(){var iP=function(bZ,bS){this._$regist(bS,bZ)};var he=function(co){return!!co&&!!co._$extend};return function(bS,bZ){if(!bL._$isString(bS)){bL._$forIn(bS,iP,this);return this}var br=dl._$appendNodeByUMI(this.__root,bS)._$getData(),co=br.module;if(dl._$isModule(co)||he(co))return this;var cB=this.__config.mg[bS],co;if(bL._$isString(bZ)||he(bZ)){co=bZ}else{bZ=bZ||cj;cB=bZ.gid;co=bZ.module;if(!!bZ.title)this.__setModuleConf(bS,"title",bZ.title);if(!!bZ.clazz)this.__setModuleConf(bS,"clazz",bZ.clazz);if(!!bZ.composite)br.composite=bZ.composite}this.__doAddUMI2Group(bS,cB);br.module=co;return this}}();cd._$message=function(){var gd=function(bR,cJ){var co=bR._$getData().module;if(dl._$isModule(co))co._$dispatchEvent("onmessage",cJ)};var dF=[gd,function(cu,cJ){var cx=cJ.from;while(!!cu){if(cu._$getPath()!=cx)gd(cu,cJ);cu=cu._$getParent()}},function(cu,cJ){var cx=cJ.from;dl._$breadthFirstSearch(cu,function(bR){if(bR._$getPath()!=cx)gd(bR,cJ)})}];return function(cJ){var bH=NEJ.X({},cJ),cu=dl._$getNodeByUMI(this.__root,bH.to);bH.path=cu._$getPath();(dF[bH.mode]||dF[0]).call(this,cu,bH)}}();cd._$publish=function(bs,cJ){var cJ=NEJ.X({},cJ);cJ.type=bs||"";this._$dispatchEvent((cJ.from||"")+":"+cJ.type,cJ)};cd._$subscribe=function(bS,bs,cK){bS=this.__config.al[bS]||bS;this._$pushEvent((bS||"")+":"+(bs||""),cK)};cd._$unsubscribe=function(bS,bs,cK){bS=this.__config.al[bS]||bS;this._$delEvent((bS||"")+":"+(bs||""),cK)};cd._$apply=function(bW){return this._$redirect(bW)};cd._$hide=function(bS){var cB=this.__config.mg[bS];if(cB==this.__pvseed){this.__groups[cB]._$hideUMI(bS)}return this};cd._$redirect=function(bW,bK){bK=bK||cj;var bS=dl._$path2umi(bW),cD=location.parse(bW);this.__dtmp[cD.path]=bK.input;if(dl._$isUMIPrivate(bS)){this.__onURLChange(cD)}else{var dr=this.__groups[this.__pbseed],bH={target:cD,umi:bS};if(!!dr._$exitable(bH)){if(location.same(bW)&&!!bK.force){this.__onURLChange(cD)}else{location.ignored=!!bK.ignored;location.redirect(bW,!!bK.replace)}}}return this};cd._$refresh=function(bW){if(!!bW){this._$redirect(bW,{replace:!0,force:!0})}else{this.__groups[this.__pbseed]._$refresh()}};cd._$delegate=function(){this.__doInitDomEvent([[document,"click",this.__onClickDelegate._$bind(this)]]);return this};cd._$active=function(){location.active();return this};cd._$loaded=function(bS,co){bS=this.__config.al[bS]||bS;if(!bL._$isArray(bS)){this._$regist(bS,co);this.__groups[this.__config.mg[bS]]._$loadedUMI(bS)}else{bL._$forEach(bS,function(bU){this._$loaded(bU,co)},this)}return this};bF._$startup=function(bK){window.dispatcher=bJ._$$Dispatcher._$getInstance(bK);bF._$parseTemplate((bK||cj).tid||"template-box");bT._$addEvent(document,"templateready",function(){window.setTimeout(dispatcher._$active._$bind(dispatcher),0)});return window.dispatcher}})();
(function(){var be=NEJ.P,bF=be("nej.e"),bG=be("nej.ut");window.dispatcher=bG._$$Dispatcher._$getInstance({rules:{rewrite:{404:"/m/a/a0/","/m/a/a0/":"/"},title:{"/m/b/":"Module B","/m/c/":"Module C"}},modules:{"/":"index/ui.html","/m":"index/m.html","/m/a":"index/a.html","/m/b/":"index/b.html","/m/c/":"index/c.html","/m/d/":"index/d.html","/m/a/a0/":{module:"index/a.a0.html",title:"Module A-A0",clazz:"g-aa0"},"/m/a/a1/":{module:"index/a.a1.html",title:"Module A-A1",clazz:"g-aa1"},"/m/a/a2/":{module:"index/a.a2.html",title:"Module A-A2",clazz:"g-aa2"},"/?/b/b0/":"index/b.b0.html","/?/b/b1/":"index/b.b1.html","/?/b/b2/":"index/b.b2.html","/?/d/d0/":{module:"index/d.d0.html",title:"Module D-D0",gid:"d"},"/?/d/d1/":{module:"index/d.d1.html",title:"Module D-D1",gid:"d"},"/?/d/d2/":{module:"index/d.d2.html",title:"Module D-D2",gid:"d"}}});bF._$parseTemplate("template-box");dispatcher._$active()})()</script> </body> </html>