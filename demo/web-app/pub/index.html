<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <title>模块调度机制 - 前端实例</title> <link href="../r/core.css?f60113d5f42327bc6e98898019f61f4b" type="text/css" rel="stylesheet"/><style type="text/css">#module-box{min-height:500px;_height:500px;}</style> </head> <body> <div class="g-doc"> <div class="g-hd"> <h1 class="m-logo">网易-杭研院-前端技术组-实例库</h1> <h2 class="m-title">模块调度机制</h2> </div> <div class="g-bd" id="module-box"></div> <div class="g-bd"> <div class="m-foot"> 如有任何问题，请联系：蔡剑飞(<a href="mailto:caijf@corp.netease.com">caijf@corp.netease.com</a>) </div> </div> <div class="g-ft"> <div class="m-foot"> &nbsp;&copy;&nbsp;网易-杭研院-前端技术组 </div> </div> </div> <div id="template-box" style="display:none;">  <textarea name="jst" id="ui-jst-0"> ui content </textarea> <textarea name="js">(function(){var V=NEJ.P,bB=NEJ.O,bH=NEJ.F,U=V("nej.e"),Z=V("nej.u"),bA=V("nej.ut"),W=V("nej.ui"),bp;if(!!W._$$Abstract)return;W._$$Abstract=NEJ.C();bp=W._$$Abstract._$extend(bA._$$Event);bp.__init=function(){this.__supInit();U._$dumpCSSText();this.__initXGui();this.__initNode()};bp.__reset=function(Y){this.__supReset(Y);this.__doInitClass(Y.clazz);this._$appendTo(Y.parent)};bp.__destroy=function(){this.__supDestroy();this.__doDelParentClass();delete this.__parent;U._$removeByEC(this.__body);U._$delClassName(this.__body,this.__class);delete this.__class};bp.__initXGui=bH;bp.__initNode=function(){if(!this.__seed_html)this.__initNodeTemplate();this.__body=U._$getNodeTemplate(this.__seed_html);if(!this.__body)this.__body=U._$create("div",this.__seed_css);U._$addClassName(this.__body,this.__seed_css)};bp.__initNodeTemplate=bH;bp.__doInitClass=function(bz){this.__class=bz||"";U._$addClassName(this.__body,this.__class)};bp.__doAddParentClass=function(){if(!this.__seed_css)return;U._$addClassName(this.__parent,this.__seed_css+"-parent")};bp.__doDelParentClass=function(){if(!this.__seed_css)return;U._$delClassName(this.__parent,this.__seed_css+"-parent")};bp._$getBody=function(){return this.__body};bp._$appendTo=function(bx){if(!this.__body)return this;this.__doDelParentClass();if(Z._$isFunction(bx)){this.__parent=bx(this.__body)}else{this.__parent=U._$get(bx);if(!!this.__parent)this.__parent.appendChild(this.__body)}this.__doAddParentClass();return this};bp._$show=function(){if(!this.__parent||!this.__body||this.__body.parentNode==this.__parent)return this;this.__parent.appendChild(this.__body);return this};bp._$hide=function(){U._$removeByEC(this.__body);return this}})();
(function(){window.dispatcher._$loaded("/",null)})()</textarea> <textarea name="jst" id="m-jst-0"> <div class="w-tab"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box"></div> </textarea> <textarea name="css">.w-tab{border-bottom:1px solid #000;overflow:hidden;text-align:center;font-size:16px;zoom:1;}.w-tab .itm{display:block;float:left;width:100px;height:30px;line-height:30px;margin-right:10px;color:#000;background:#aaa;}.w-tab .itm:hover{text-decoration:none;}.w-tab .js-selected{background:#000;color:#fff;}.w-box{padding:10px 0;}</textarea><textarea name="js">(function(){var V=NEJ.P,U=V("nej.e"),bi=V("nej.v"),Z=V("nej.u"),bA=V("dm.ut"),W=NEJ.P("dm.m"),bv=window,ec,hQ;W._$$ModuleM=NEJ.C();ec=W._$$ModuleM._$extend(bA._$$Module,!0);hQ=W._$$ModuleM._$supro;ec.__doBuild=function(){this.__xlist=[{url:"/m/a/",name:"A",umi:"/m/a/a0/"},{url:"/m/b/",name:"B"},{url:"/m/c/",name:"C"},{url:"/m/d/",name:"D"}];this.__body=U._$create("div");U._$renderHtmlTemplate(this.__body,"m-jst-0",{xlist:this.__xlist});var bc=U._$getChildren(this.__body);this.__export.box=bc[1];this.__tab=U._$tab(bc[0],{clazz:"js-tag"});this.__tab._$setEvent("onchange",this.__onTabChange._$bind(this))};ec.__doSyncTab=function(bj){var by=Z._$indexOf(this.__xlist,function(bV){return bj.indexOf(bV.url)>=0});if(by<0)return;this.__tab._$go(by);var bs=this.__xlist[0];if(bj.indexOf(bs.url)>=0)bs.umi=bj};ec.__onTabChange=function(S){var bs=this.__xlist[S.index];bv.dispatcher._$redirect(bs.umi||bs.url)};ec.__onShow=function(S){this.__doSyncTab(S.href);hQ.__onShow.apply(this,arguments)};ec.__onRefresh=function(S){this.__doSyncTab(S.href)};bv.dispatcher._$loaded("/m",W._$$ModuleM)})()</textarea> <textarea name="jst" id="a-jst-0"> <div class="w-tab2"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box2"></div> </textarea> <textarea name="css">.m-a .w-tab2{float:left;width:100px;margin-right:-100px;text-align:center;font-size:14px;}.m-a .w-tab2 .itm{display:block;height:30px;line-height:30px;margin-bottom:5px;color:#000;background:#ccc;}.m-a .w-tab2 .itm:hover{text-decoration:none;}.m-a .w-tab2 .js-selected{background:#888;color:#fff;font-weight:bold;}.m-a .w-box2{margin-left:100px;padding-left:10px;border-left:1px solid #888;}</textarea><textarea name="js">(function(){var V=NEJ.P,U=V("nej.e"),bi=V("nej.v"),Z=V("nej.u"),bA=V("dm.ut"),W=NEJ.P("dm.m"),bv=window,eb,hG;W._$$ModuleA=NEJ.C();eb=W._$$ModuleA._$extend(bA._$$Module,!0);hG=W._$$ModuleA._$supro;eb.__doBuild=function(){this.__xlist=[{url:"/m/a/a0/",name:"A0"},{url:"/m/a/a1/",name:"A1"},{url:"/m/a/a2/",name:"A2"}];this.__body=U._$create("div","m-a");U._$renderHtmlTemplate(this.__body,"a-jst-0",{xlist:this.__xlist});var bc=U._$getChildren(this.__body);this.__export.box=bc[1];this.__tab=U._$tab(bc[0],{clazz:"js-tag"});this.__tab._$setEvent("onchange",this.__onTabChange._$bind(this))};eb.__doSyncTab=function(bj){var by=Z._$indexOf(this.__xlist,function(bV){return bV.url===bj});if(by<0)return;this.__tab._$go(by)};eb.__onTabChange=function(S){bv.dispatcher._$redirect(this.__xlist[S.index].url)};eb.__onShow=function(S){this.__doSyncTab(S.href);hG.__onShow.apply(this,arguments)};eb.__onRefresh=function(S){this.__doSyncTab(S.href)};bv.dispatcher._$loaded("/m/a",W._$$ModuleA)})()</textarea>  </div> <script type="text/javascript">location.config = {"ver":{"index/a.a0.html":"9a8fb1e6723e74a3d180f3d900646f3e","index/a.a1.html":"1bc7fa3be18169687eb11eedc3c98684","index/a.a2.html":"2f8d4de69ec705bff8d677593bce1ac2","index/a.html":"92d07f4d9c4eacaadfb54c431618f17c","index/b.b0.html":"f79a393b53bca87e4e33a9f12366fae4","index/b.b1.html":"118f1294eb5cc019d48f50bc0842aa2f","index/b.b2.html":"71378dd1ab370cc3a97a5a07ca21087f","index/b.html":"0c4051765aa1028f21588ea473856b3e","index/c.html":"506eb03d1ee95a32c433cf8a90b85005","index/d.d0.html":"125b8bb3d930840eab52e092541c20f8","index/d.d1.html":"c8f08067848236b2bbacca9c3458e4d5","index/d.d2.html":"a45dd50315dffc3a4aa13743ae3dd670","index/d.html":"2f626fe7995b06c0a01f83781121654f","index/m.html":"ff12900ea14d36c11541ec182c79218b","index/ui.html":"dbf2f00fa2893f0b5fec1b4094e5ce2a","index.html":"7bd3b12b030deb633e18f4b109909d43","simple.html":"38eea7f2be9904ec341430fea0ee3a93","test/a.html":"7b52dd9dcc114f4d9f9a581a454368a9","test/b.html":"7b52dd9dcc114f4d9f9a581a454368a9"},"root":"./"};</script> <div style="display:none;" id="umi://index/a.a0.html"><meta charset="utf-8"/> <textarea name="ntp" id="a0-ntp-0"> <div class="m-a0"> <input type="button" value="send message to C"/> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> </div> </textarea> <textarea name="css">.m-a0{min-height:500px;_height:500px;background:#f00;}.m-a0 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var V=NEJ.P,U=V("nej.e"),bi=V("nej.v"),Z=V("nej.u"),bA=V("dm.ut"),W=NEJ.P("dm.m"),bv=window,gC,jN;W._$$ModuleA0=NEJ.C();gC=W._$$ModuleA0._$extend(bA._$$Module,!0);jN=W._$$ModuleA0._$supro;gC.__doBuild=function(){this.__body=U._$getNodeTemplate("a0-ntp-0");bi._$addEvent(this.__body.getElementsByTagName("input")[0],"click",this.__doSendMessage._$bind(this))};gC.__doSendMessage=function(){bv.dispatcher._$message({to:"/m/c/",from:this.__umi,data:"hello C! my name is a0."})};bv.dispatcher._$loaded("/m/a/a0/",W._$$ModuleA0)})()</textarea></div><div style="display:none;" id="umi://index/a.a1.html"><meta charset="utf-8"/> <textarea name="ntp" id="a1-ntp-0"> <div class="m-a1"> <input type="button" value="send message to C"/> <input type="button" value="send message to A0"/> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> </div> </textarea> <textarea name="css">.m-a1{min-height:500px;_height:500px;background:#fdc;}.m-a1 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var V=NEJ.P,U=V("nej.e"),bi=V("nej.v"),Z=V("nej.u"),bA=V("dm.ut"),W=NEJ.P("dm.m"),bv=window,gB,jP;W._$$ModuleA1=NEJ.C();gB=W._$$ModuleA1._$extend(bA._$$Module,!0);jP=W._$$ModuleA1._$supro;gB.__doBuild=function(){this.__body=U._$getNodeTemplate("a1-ntp-0");var bc=this.__body.getElementsByTagName("input");bi._$addEvent(bc[0],"click",this.__doSendMessage._$bind(this,"/m/c/"));bi._$addEvent(bc[1],"click",this.__doSendMessage._$bind(this,"/m/a/a0/"))};gB.__doSendMessage=function(cB){bv.dispatcher._$message({to:cB,from:this.__umi,data:"hello C! my name is a1."})};bv.dispatcher._$loaded("/m/a/a1/",W._$$ModuleA1)})()</textarea></div><div style="display:none;" id="umi://index/a.a2.html"><meta charset="utf-8"/> <textarea name="ntp" id="a2-ntp-0"> <div class="m-a2"> <input type="button" value="send message to C"/> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> </div> </textarea> <textarea name="css">.m-a2{min-height:500px;_height:500px;background:#aaa;}.m-a2 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var V=NEJ.P,U=V("nej.e"),bi=V("nej.v"),Z=V("nej.u"),bA=V("dm.ut"),W=NEJ.P("dm.m"),bv=window,gm,jR;W._$$ModuleA2=NEJ.C();gm=W._$$ModuleA2._$extend(bA._$$Module,!0);jR=W._$$ModuleA2._$supro;gm.__doBuild=function(){this.__body=U._$getNodeTemplate("a2-ntp-0");bi._$addEvent(this.__body.getElementsByTagName("input")[0],"click",this.__doSendMessage._$bind(this))};gm.__doSendMessage=function(){bv.dispatcher._$message({to:"/m/c/",from:this.__umi,data:"hello C! my name is a2."})};bv.dispatcher._$loaded("/m/a/a2/",W._$$ModuleA2)})()</textarea></div><script src="../r/core.js?c9efebe522323e1d360568a454b156e8" type="text/javascript"></script><script type="text/javascript">(function(){var V=NEJ.P,bB=NEJ.O,Z=V("nej.u"),bA=V("nej.ut"),W=V("nej.ut.p"),cx;if(!!W._$$Node)return;W._$$Node=NEJ.C();cx=W._$$Node._$extend(bA._$$Event);cx.__init=function(){this.__supInit();this.__children=[]};cx.__reset=function(Y){this.__supReset(Y);this._$setParent(Y.parent);this.__name=Y.name||"/";this.__data=Y.data||{}};cx.__destroy=function(){var ey=function(bg,by,bc){bc.splice(by,1);bg._$recycle()};return function(){this.__supDestroy();delete this.__data;Z._$reverseEach(this.__children,ey);this._$setParent(null)}}();cx.__isNode=function(bg){return bg instanceof W._$$Node};cx.__hasChild=function(cv){return Z._$indexOf(this.__children,cv)>=0};cx._$getName=function(){return this.__name};cx._$getData=function(){return this.__data};cx._$getPath=function(){var bx=this._$getParent(),be=this._$getName();if(!bx)return be;var ee=bx._$getName();if(ee!="/"&&be!="/")be="/"+be;return bx._$getPath()+be};cx._$getParent=function(){return this.__parent};cx._$getChildren=function(){return this.__children};cx._$getChildByName=function(be){var by=Z._$indexOf(this.__children,function(bg){return be==bg._$getName()});return this.__children[by]||null};cx._$setParent=function(bx){bx=this.__isNode(bx)?bx:null;if(bx==this.__parent)return;!!bx?bx._$appendChild(this):this.__parent._$removeChild(this);this.__parent=bx;return this};cx._$appendChild=function(cv){cv=this.__isNode(cv)?cv:null;if(!cv||this.__hasChild(cv))return;this.__children.push(cv);cv._$setParent(this);return this};cx._$removeChild=function(cv){cv=this.__isNode(cv)?cv:null;var by=Z._$indexOf(this.__children,cv);if(by>=0){this.__children.splice(by,1);cv._$setParent(null)}return cv}})();
(function(){var V=NEJ.P,bH=NEJ.F,Z=V("nej.u"),bA=V("nej.ut"),W=V("nej.ut.p");var em=function(bQ,bj,gi){var bg=bQ,gi=gi||bH;if(bj!="/"){Z._$forEach(bj.split("/"),function(be){var bq=gi(bg,be);if(!bq)return!0;bg=bq})}return bg};W._$getNodeByUMI=function(){var ez=function(bx,be){var be=be||"/",ee=bx._$getName();if(ee=="/"&&be=="/")return bx;return bx._$getChildByName(be)};return function(bQ,bj){return em(bQ,bj,ez)}}();W._$appendNodeByUMI=function(){var ku=function(bx,be){var ee=bx._$getName();if(!be&&ee=="/")return bx;var bg=null;if(ee!="/"){bg=bx._$getChildByName("/");if(!bg){bg=W._$$Node._$allocate();bx._$appendChild(bg)}}if(!!be){bg=bx._$getChildByName(be);if(!bg){bg=W._$$Node._$allocate({name:be});bx._$appendChild(bg)}}return bg};return function(bQ,bj){return em(bQ,bj,ku)}}();W._$getCommonRoot=function(bQ,cw,bM){if(!cw||!bM)return bQ;var cw=cw._$getPath().split("/"),bM=bM._$getPath().split("/"),kw=Z._$forIn(cw,function(bm,by){if(bm!=bM[by])return!0})||1,bj=cw.splice(0,kw).join("/")||"/";return W._$getNodeByUMI(bQ,bj)};W._$breadthFirstSearch=function(bQ,bu){var bw=[bQ],bg=bw.shift(),bu=bu||bH;while(!!bg){bw.push.apply(bw,bg._$getChildren());bu(bg);bg=bw.shift()}return this};W._$isNode=function(bg){return bg instanceof W._$$Node};W._$isModule=function(bG){return bG instanceof bA._$$Module};W._$isUMIPrivate=function(){var bF=/^\/?\?(?=\/|$)/;return function(bj){return bF.test(bj||"")}}();W._$path2umi=function(){var bF=/[\?#]/;return function(bn){var bw=(bn||"").trim().split(bF),ky=bw[0]=="/"&&(bw[1]||"").indexOf("/")==0;return bw[0]+(ky?"?"+bw[1]:"")}}()})();
(function(){var V=NEJ.P,bB=NEJ.O,bv=V("nej.g"),U=V("nej.e"),bO=V("nej.j"),Z=V("nej.u"),bA=V("nej.ut"),W=V("nej.ut.p"),cp;if(!!W._$$GroupManager)return;W._$$GroupManager=NEJ.C();cp=W._$$GroupManager._$extend(bA._$$Event);cp.__reset=function(Y){this.__supReset(Y);this.__root=Y.root;this.__dispatcher=Y.dispatcher;this.__mpool={}};cp.__destroy=function(){this.__supDestroy();delete this.__root;delete this.__mpool};cp.__isStopped=function(bg){if(!W._$isNode(bg))return!1;return!!bg._$getData().stopped||this.__isStopped(bg._$getParent())};cp.__doClearStopped=function(bg){if(!W._$isNode(bg))return;delete bg._$getData().stopped;this.__doClearStopped(bg._$getParent())};cp.__doModuleHide=function(bP,cB){this.__doModuleCheck("onhide",bP,cB)};cp.__doModuleShow=function(bP,cB){this.__doModuleCheck("onshow",bP,cB);this.__doModuleAction(bP)};cp.__doModuleRefresh=function(bg){this.__doModuleCheck("onrefresh",bg);this.__doModuleAction(bg)};cp.__doModuleCheck=function(bh,bP,cB){if(bP==cB||!W._$isNode(bP))return;if(bh=="onhide")this.__doModuleDispatch(bP,bh);this.__doModuleCheck(bh,bP._$getParent(),cB);if(bh!="onhide")this.__doModuleDispatch(bP,bh)};cp.__doModuleAction=function(bg){if(!W._$isNode(bg))return!0;var bl=bg._$getData(),cL=bl.action,bG=bl.module;if(!this.__doModuleAction(bg._$getParent())||!!cL&&Z._$isString(bG))return!1;if(!!bG&&!!bG._$allocate&&!!cL&&cL!="onhide"){if(this.__isStopped(bg))return;var Y={umi:bg._$getPath(),composite:bl.composite,dispatcher:this.__dispatcher};bG=bG._$allocate(Y);if(W._$isModule(bG)){bl.module=bG;this.__doModuleDispatch(bg,"onshow")}else{delete bl.module}}delete bl.action;return!0};cp.__doModuleDispatch=function(){var kB=function(bg){var bG;bg=bg._$getParent();while(!!bg){bG=bg._$getData().module;if(W._$isModule(bG)){return bG._$getExportData()}bg=bg._$getParent()}return null};return function(bg,be){if(!W._$isNode(bg))return;var bl=bg._$getData(),bG=bl.module,fN=be!="onhide";if(W._$isModule(bG)){if(fN&&this.__isStopped(bg))return;var S=!this.__source?bl.event:this.__source._$getData().event;if(!!S){S.umi=bg._$getPath();S.data=kB(bg)}var hU=bl.xname||"onhide";if(be=="onshow"&&hU!="onhide")be="onrefresh";if(be=="onrefresh"&&hU=="onhide")be="onshow";bl.xname=be;bG._$dispatchEvent(be,S||{});if(fN&&!!S&&!!S.pos&&S.umi==S.target){U._$scrollTo(S.pos)}if(fN&&!!S){bl.stopped=S.stopped;delete S.stopped}}else if(!!bG){bl.action=be;if(be=="onshow"&&Z._$isString(bG)){var T=U._$get("umi://"+bG);if(!!T){U._$parseTemplate(T)}else{var bs=location.config||bB;bO._$loadHtml((bs.root||"")+bG,{version:(bs.ver||bB)[bG],onloaded:U._$parseTemplate})}}}}}();cp._$hasUMI=function(bj){return!!this.__mpool[bj]};cp._$addUMI=function(bj){this.__mpool[bj]=!0;return this};cp._$delUMI=function(bj){delete this.__mpool[bj];return this};cp._$loadedUMI=function(bj){if(this._$hasUMI(bj))this.__doModuleAction(W._$getNodeByUMI(this.__root,bj));return this};cp._$dispatchUMI=function(bj){if(this._$hasUMI(bj)){var bg=W._$getNodeByUMI(this.__root,bj);this.__doClearStopped(bg);this.__doModuleShow(bg)}return this};cp._$hideUMI=function(bj){if(this._$hasUMI(bj)){this.__doModuleHide(W._$getNodeByUMI(this.__root,bj))}return this}})();
(function(){var V=NEJ.P,bB=NEJ.O,bH=NEJ.F,U=V("nej.e"),W=V("nej.ut.p"),dn;if(!!W._$$SingleGroupManager)return;W._$$SingleGroupManager=NEJ.C();dn=W._$$SingleGroupManager._$extend(W._$$GroupManager);dn.__reset=function(Y){this.__supReset(Y);this.__classed=!!Y.classed};dn.__destroy=function(){this.__supDestroy();delete this.__cmroot;delete this.__source};dn._$exitable=function(S){if(!this.__source)return!0;var bG=this.__source._$getData().module;if(W._$isModule(bG))bG._$dispatchEvent("onbeforehide",S);return!S.stopped};dn._$refresh=function(){if(!this.__source)return;window.setTimeout(this._$dispatchUMI._$bind(this,this.__source._$getPath()),0)};dn._$dispatchUMI=function(bj){if(!this._$hasUMI(bj))return this;var bM=W._$getNodeByUMI(this.__root,bj),bl=bM._$getData();if(!bl.module)return this;var cw=this.__source,S=bl.event,fG=bB;this.__source=bM;this.__doClearStopped(bM);if(!!cw){fG=cw._$getData().event;S.referer=fG.href||""}if(cw==bM){this.__doModuleRefresh(this.__source);return this}this.__cmroot=W._$getCommonRoot(this.__root,cw,bM);if(cw!=null){if(cw!=this.__cmroot){if(this.__classed)U._$delClassName(document.body,fG.clazz);this.__doModuleHide(cw,this.__cmroot)}this.__doModuleRefresh(this.__cmroot)}else{this.__doModuleShow(this.__cmroot)}if(bM!=this.__cmroot){if(this.__classed)U._$addClassName(document.body,S.clazz);this.__doModuleShow(bM,this.__cmroot)}return this};dn._$loadedUMI=function(bj){if(this._$hasUMI(bj))this.__doModuleAction(this.__source);return this};dn._$hideUMI=bH})();
(function(){var V=NEJ.P,bi=V("nej.v"),Z=V("nej.u"),eG=V("nej.p"),ba=V("nej.h"),bA=V("nej.ut"),cJ=/^[#?]+/,eL=/#(.*?)$/,di=window,fE=!history.pushState||eG._$IS.android||!history.auto;var fp=function(bn,gu){di.history[!gu?"pushState":"replaceState"](null,document.title,bn)};var fq=function(){return location.parse(di.location.href)};fp=fp._$aop(function(S){if(!fE)return;var bb=S.args;S.stopped=!0;bn=bb[0].replace(cJ,"");!bb[1]?di.location.hash=bn:di.location.replace("#"+bn)});fq=fq._$aop(function(S){if(!fE)return;S.stopped=!0;var dy=eL.test(di.location.href)?RegExp.$1:"";S.value=location.parse(dy.replace(cJ,""))});location.redirect=function(bn,gu){fp(bn,gu);return this};location.active=function(){var dK,bn,bY,fZ,hW;var fW=function(cS){if(!!fZ){fZ=!1;return}var S={oldValue:bY,newValue:fq()};if(!!location.ignored){location.ignored=!1}else{bi._$dispatchEvent(location,"beforeurlchange",S);if(S.stopped){if(!!bY){fZ=!0;fp(bY.href,!0)}return}}bn=di.location.href;bY=S.newValue;bi._$dispatchEvent(location,"urlchange",bY);ba.__pushHistory(bY.href)};var hY=function(){if(bn!=di.location.href)fW();dK=requestAnimationFrame(hY)};return function(dx){if(!!hW)return this;hW=!0;di=dx||window;if(fE&&"onhashchange"in window&&eG._$NOT_PATCH.trident2){bi._$addEvent(di,"hashchange",fW);fW()}else if(!dK){dK=requestAnimationFrame(hY)}return this}}();location.parse=function(){var ch=/^https?:\/\/.*?\//i,cJ=/[?#]/;return function(bn){var bq={href:bn};bn=(bn||"").replace(ch,"/").split(cJ);var cR=1;if(bn[0]=="/"&&(bn[1]||"").indexOf("/")==0)cR=2;bq.path=bn.splice(0,cR).join("?");bq.query=Z._$query2object(bn.join("&"));return bq}}();location.same=function(bn){return fq().href==bn};bA._$$CustomEvent._$allocate({element:location,event:["beforeurlchange","urlchange"]})})();
(function(){var V=NEJ.P,bB=NEJ.O,bH=NEJ.F,U=V("nej.e"),bi=V("nej.v"),Z=V("nej.u"),W=V("nej.ut"),cE=V("nej.ut.p"),bp;if(!!W._$$Dispatcher)return;W._$$Dispatcher=NEJ.C();bp=W._$$Dispatcher._$extend(W._$$Event);bp.__init=function(){this.__supInit();var bT=+(new Date);this.__pbseed="pb-"+bT;this.__pvseed="pv-"+bT};bp.__reset=function(Y){this.__dtmp={};this.__rest=!!Y.rest;this.__root=cE._$$Node._$allocate();this.__config={m:{},mg:{},r:[],rr:{},al:{},am:{}};this.__groups={};this.__doBuildGroup(this.__pbseed);this.__groups[this.__pvseed]=cE._$$GroupManager._$allocate({root:this.__root,dispatcher:this});this.__doInitDomEvent([[location,"urlchange",this.__onURLChange._$bind(this)]]);this.__supReset(Y);this._$rule(Y.rules);this._$regist(Y.modules)};bp.__destroy=function(){var ey=function(cI,bk,bo){delete bo[bk];cI._$recycle()};return function(){delete this.__config;this.__root=this.__root._$recycle();Z._$forIn(this.__groups,ey);this.__supDestroy()}}();bp.__setModuleConf=function(bj,bk,bm){var dG=this.__config.m[bj];if(!dG){dG={};this.__config.m[bj]=dG}dG[bk]=bm};bp.__getModuleConf=function(bj,bk){var dG=this.__config.m[bj];return!dG?"":dG[bk]};bp.__doBuildGroup=function(bW){if(!bW)return;var cI=this.__groups[bW];if(!cI){cI=cE._$$SingleGroupManager._$allocate({root:this.__root,dispatcher:this,classed:bW==this.__pbseed});this.__groups[bW]=cI}return cI};bp.__doAddUMI2Group=function(bj,bW){var cI=this.__doBuildGroup(bW);if(!cI){bW=cE._$isUMIPrivate(bj)?this.__pvseed:this.__pbseed;cI=this.__groups[bW]}cI._$addUMI(bj);this.__config.mg[bj]=bW};bp.__doRewriteUMI=function(){var bF=/\$\d/;return function(bj,cS){var bq;Z._$forIn(this.__config.r,function(bs){Z._$forIn(bs,function(bm,bk){if(!!bm.test&&(bm.test(bj)||bm.test(cS))){bq=bF.test(bk)?bj.replace(bm,bk):bk;return!0}if(bm===bj||bm===cS){bq=bk;return!0}});return!!bq});return bq||bj}}();bp.__onURLChange=function(){var dU=/(?:^\/+)|(?:\/+$)/gi,ch=/#(\$.*?)$/;var kU=function(bj,bg){var dO=bg._$getPath(),bj=bj.replace(dO,"").replace(dU,"");return bj.split("/")};var ie=function(bj,bo){var bm,bw=bj.split("/");while(bw.length>0){if(!bw[bw.length-1]){bw.pop()}else{bw[bw.length-1]=""}bm=bo[bw.join("/")];if(!!bm)return bm}return""};return function(bY){if(bY.path.indexOf("$")==0)return;var kW=this.__dtmp[bY.path];delete this.__dtmp[bY.path];this._$dispatchEvent("onbeforechange",bY);var bj=this.__doRewriteUMI(bY.path,bY.href),bW=this.__config.mg[bj];if(!bW&&this.__rest)bW=ie(bj,this.__config.mg);if(!bW&&!cE._$isUMIPrivate(bj)){bj=this.__config.rr["404"];bW=this.__config.mg[bj]}if(!bW&&this.__rest)bW=ie(bj,this.__config.mg);if(!bW)return;var bg=cE._$getNodeByUMI(this.__root,bj),ig=null;if(this.__rest)ig=kU(bj,bg);var cw=bj;bj=bg._$getPath();bg._$getData().event={target:bj,source:cw,href:bY.href,param:bY.query,input:kW,prest:ig,clazz:this.__getModuleConf(bj,"clazz"),pos:ch.test(bY.href)?RegExp.$1:""};var fz=this.__getModuleConf(cw,"title");if(!!fz)document.title=fz;this.__groups[bW]._$dispatchUMI(bj)}}();bp.__onClickDelegate=function(){var ii=function(bn,cS){if(!bn)return;var ed=location.parse(bn);this._$dispatchEvent("onbeforechange",ed);var bj=this.__doRewriteUMI(ed.path,cS||ed.href);return this.__groups[this.__pbseed]._$hasUMI(bj)};var em=function(bg){var bj=U._$dataset(bg,"href");if(!!bj)return bj;var cS=U._$attr(bg,"href");if(!!cS&&!U._$dataset(bg,"notUmi")){var bw=cS.split("#");bw.shift();var bj=bw.join("#");if(ii.call(this,bj,cS)){return bj}if(ii.call(this,cS)){var ed=location.parse(cS);return ed.path+"?"+Z._$object2query(ed.query)}}};var lb=function(bg){return!!em.call(this,bg)};return function(S){var T=bi._$getElement(S,lb._$bind(this));if(!!T){bi._$stopDefault(S);this._$redirect(em.call(this,T))}}}();bp.__onActionDelegate=function(S){var ep=this.__config.am,ci=ep[S.type];if(!ci)return;var T=bi._$getElement(S,"d:resAction");if(!T)return;var cL=U._$dataset(T,"resAction"),bu=ci[cL];if(!bu)return;var Y={action:cL,target:T,id:U._$dataset(T,"resId"),type:U._$dataset(T,"resType"),extra:U._$dataset(T,"resExtra")};this._$dispatchEvent("onbeforeaction",{event:S,target:T,result:Y});bu.call(this,Y)};bp._$rule=function(){var ld=["404"];var le=function(bs,bk){this._$rule(bk,bs)};var lf=function(fz,bj){this.__setModuleConf(bj,"title",fz)};var lg=function(bj,lh){this.__config.al[lh]=bj};var gE=function(bs){if(!bs)return;this.__config.r.push(bs);Z._$forEach(ld,function(bk){if(!bs[bk])return;this.__config.rr[bk]=bs[bk];delete bs[bk]},this)};var lj=function(cL,be){var ep=this.__config.am;var S="click",bu=cL,be=(be||"").toLowerCase();if(Z._$isObject(cL)){S=cL.event||S;bu=cL.value}if(Z._$isString(bu)){bu=function(bj,Y){this._$redirect(bj,{force:!0,input:Y})}._$bind(this,bu)}else if(Z._$isFunction(bu)){bu=bu._$aop(null,function(S){var bq=S.value;if(Z._$isString(bq)){this._$redirect(bq,{force:!0,input:S.args[0]})}}._$bind(this))}if(Z._$isFunction(bu)){if(!ep[S]){this.__doInitDomEvent([[document,S,this.__onActionDelegate._$bind(this)]]);ep[S]={}}ep[S][be]=bu}};var dj={title:function(bs){Z._$forIn(bs,lf,this)},rewrite:function(bs){if(!Z._$isArray(bs)){gE.call(this,bs)}else{Z._$forEach(bs,gE,this)}},alias:function(bs){Z._$forIn(bs,lg,this)},action:function(bs){Z._$forIn(bs,lj,this)}};return function(bk,bs){if(Z._$isArray(bk)){bs=bk;bk="rewrite"}else if(!Z._$isString(bk)){Z._$forIn(bk,le,this);return this}(dj[bk]||bH).call(this,bs);return this}}();bp._$regist=function(){var jf=function(bs,bj){this._$regist(bj,bs)};var gY=function(bG){return!!bG&&!!bG._$extend};return function(bj,bs){if(!Z._$isString(bj)){Z._$forIn(bj,jf,this);return this}var bl=cE._$appendNodeByUMI(this.__root,bj)._$getData(),bG=bl.module;if(cE._$isModule(bG)||gY(bG))return this;var bW=this.__config.mg[bj],bG;if(Z._$isString(bs)||gY(bs)){bG=bs}else{bs=bs||bB;bW=bs.gid;bG=bs.module;if(!!bs.title)this.__setModuleConf(bj,"title",bs.title);if(!!bs.clazz)this.__setModuleConf(bj,"clazz",bs.clazz);if(!!bs.composite)bl.composite=bs.composite}this.__doAddUMI2Group(bj,bW);bl.module=bG;return this}}();bp._$message=function(){var ga=function(bg,cd){var bG=bg._$getData().module;if(cE._$isModule(bG))bG._$dispatchEvent("onmessage",cd)};var dj=[ga,function(bM,cd){var bP=cd.from;while(!!bM){if(bM._$getPath()!=bP)ga(bM,cd);bM=bM._$getParent()}},function(bM,cd){var bP=cd.from;cE._$breadthFirstSearch(bM,function(bg){if(bg._$getPath()!=bP)ga(bg,cd)})}];return function(cd){var S=NEJ.X({},cd),bM=cE._$getNodeByUMI(this.__root,S.to);S.path=bM._$getPath();(dj[S.mode]||dj[0]).call(this,bM,S)}}();bp._$publish=function(bh,cd){var cd=NEJ.X({},cd);cd.type=bh||"";this._$dispatchEvent((cd.from||"")+":"+cd.type,cd)};bp._$subscribe=function(bj,bh,cl){bj=this.__config.al[bj]||bj;this._$pushEvent((bj||"")+":"+(bh||""),cl)};bp._$unsubscribe=function(bj,bh,cl){bj=this.__config.al[bj]||bj;this._$delEvent((bj||"")+":"+(bh||""),cl)};bp._$apply=function(bn){return this._$redirect(bn)};bp._$hide=function(bj){var bW=this.__config.mg[bj];if(bW==this.__pvseed){this.__groups[bW]._$hideUMI(bj)}return this};bp._$redirect=function(bn,Y){Y=Y||bB;var bj=cE._$path2umi(bn),bY=location.parse(bn);this.__dtmp[bY.path]=Y.input;if(cE._$isUMIPrivate(bj)){this.__onURLChange(bY)}else{var cI=this.__groups[this.__pbseed],S={target:bY,umi:bj};if(!!cI._$exitable(S)){if(location.same(bn)&&!!Y.force){this.__onURLChange(bY)}else{location.ignored=!!Y.ignored;location.redirect(bn,!!Y.replace)}}}return this};bp._$refresh=function(bn){if(!!bn){this._$redirect(bn,{replace:!0,force:!0})}else{this.__groups[this.__pbseed]._$refresh()}};bp._$delegate=function(){this.__doInitDomEvent([[document,"click",this.__onClickDelegate._$bind(this)]]);return this};bp._$active=function(){location.active();return this};bp._$loaded=function(bj,bG){bj=this.__config.al[bj]||bj;if(!Z._$isArray(bj)){this._$regist(bj,bG);this.__groups[this.__config.mg[bj]]._$loadedUMI(bj)}else{Z._$forEach(bj,function(bk){this._$loaded(bk,bG)},this)}return this};U._$startup=function(Y){window.dispatcher=W._$$Dispatcher._$getInstance(Y);U._$parseTemplate((Y||bB).tid||"template-box",location.config);bi._$addEvent(document,"templateready",function(){window.setTimeout(dispatcher._$active._$bind(dispatcher),0)});return window.dispatcher}})();
(function(){var V=NEJ.P,U=V("nej.e"),bA=V("nej.ut");window.dispatcher=bA._$$Dispatcher._$getInstance({rules:{rewrite:{404:"/m/a/a0/","/m/a/a0/":"/"},title:{"/m/b/":"Module B","/m/c/":"Module C"}},modules:{"/":"index/ui.html","/m":"index/m.html","/m/a":"index/a.html","/m/b/":"index/b.html","/m/c/":"index/c.html","/m/d/":"index/d.html","/m/a/a0/":{module:"index/a.a0.html",title:"Module A-A0",clazz:"g-aa0"},"/m/a/a1/":{module:"index/a.a1.html",title:"Module A-A1",clazz:"g-aa1"},"/m/a/a2/":{module:"index/a.a2.html",title:"Module A-A2",clazz:"g-aa2"},"/?/b/b0/":"index/b.b0.html","/?/b/b1/":"index/b.b1.html","/?/b/b2/":"index/b.b2.html","/?/d/d0/":{module:"index/d.d0.html",title:"Module D-D0",gid:"d"},"/?/d/d1/":{module:"index/d.d1.html",title:"Module D-D1",gid:"d"},"/?/d/d2/":{module:"index/d.d2.html",title:"Module D-D2",gid:"d"}}});U._$parseTemplate("template-box");dispatcher._$active()})()</script> </body> </html>