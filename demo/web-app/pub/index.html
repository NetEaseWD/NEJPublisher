<!DOCTYPE html> <html> <head> <meta charset="utf-8"/> <title>模块调度机制 - 前端实例</title> <link href="../r/core.css?f60113d5f42327bc6e98898019f61f4b" type="text/css" rel="stylesheet"/><style type="text/css">#module-box{min-height:500px;_height:500px;}</style> </head> <body> <div class="g-doc"> <div class="g-hd"> <h1 class="m-logo">网易-杭研院-前端技术组-实例库</h1> <h2 class="m-title">模块调度机制</h2> </div> <div class="g-bd" id="module-box"></div> <div class="g-bd"> <div class="m-foot"> 如有任何问题，请联系：蔡剑飞(<a href="mailto:caijf@corp.netease.com">caijf@corp.netease.com</a>) </div> </div> <div class="g-ft"> <div class="m-foot"> &nbsp;&copy;&nbsp;网易-杭研院-前端技术组 </div> </div> </div> <div id="template-box" style="display:none;">  <textarea name="jst" id="ui-jst-0"> ui content </textarea> <textarea name="js">(function(){var u=NEJ.P,bp=NEJ.O,bw=NEJ.F,q=u("nej.e"),B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ui"),cJ;if(!!z._$$Abstract)return;z._$$Abstract=NEJ.C();cJ=z._$$Abstract._$extend(bo._$$Event);cJ.__init=function(){this.__supInit();q._$dumpCSSText();this.__initXGui();this.__initNode()};cJ.__reset=function(A){this.__supReset(A);this.__doInitClass(A.clazz);this._$appendTo(A.parent)};cJ.__destroy=function(){this.__supDestroy();this.__doDelParentClass();delete this.__parent;q._$removeByEC(this.__body);q._$delClassName(this.__body,this.__class);delete this.__class};cJ.__initXGui=bw;cJ.__initNode=function(){if(!this.__seed_html)this.__initNodeTemplate();this.__body=q._$getNodeTemplate(this.__seed_html);if(!this.__body)this.__body=q._$create("div",this.__seed_css);q._$addClassName(this.__body,this.__seed_css)};cJ.__initNodeTemplate=bw;cJ.__doInitClass=function(bn){this.__class=bn||"";q._$addClassName(this.__body,this.__class)};cJ.__doAddParentClass=function(){if(!this.__seed_css)return;q._$addClassName(this.__parent,this.__seed_css+"-parent")};cJ.__doDelParentClass=function(){if(!this.__seed_css)return;q._$delClassName(this.__parent,this.__seed_css+"-parent")};cJ._$getBody=function(){return this.__body};cJ._$appendTo=function(bi){if(!this.__body)return this;this.__doDelParentClass();if(B._$isFunction(bi)){this.__parent=bi(this.__body)}else{this.__parent=q._$get(bi);if(!!this.__parent)this.__parent.appendChild(this.__body)}this.__doAddParentClass();return this};cJ._$show=function(){if(!this.__parent||!this.__body||this.__body.parentNode==this.__parent)return this;this.__parent.appendChild(this.__body);return this};cJ._$hide=function(){q._$removeByEC(this.__body);return this}})();
(function(){window.dispatcher._$loaded("/",null)})()</textarea> <textarea name="jst" id="m-jst-0"> <div class="w-tab"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box"></div> </textarea> <textarea name="css">.w-tab{border-bottom:1px solid #000;overflow:hidden;text-align:center;font-size:16px;zoom:1;}.w-tab .itm{display:block;float:left;width:100px;height:30px;line-height:30px;margin-right:10px;color:#000;background:#aaa;}.w-tab .itm:hover{text-decoration:none;}.w-tab .js-selected{background:#000;color:#fff;}.w-box{padding:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,fj,lP;z._$$ModuleM=NEJ.C();fj=z._$$ModuleM._$extend(bo._$$Module,!0);lP=z._$$ModuleM._$supro;fj.__doBuild=function(){this.__xlist=[{url:"/m/a/",name:"A",umi:"/m/a/a0/"},{url:"/m/b/",name:"B"},{url:"/m/c/",name:"C"},{url:"/m/d/",name:"D"}];this.__body=q._$create("div");q._$renderHtmlTemplate(this.__body,"m-jst-0",{xlist:this.__xlist});var G=q._$getChildren(this.__body);this.__export.box=G[1];this.__tab=q._$tab(G[0],{clazz:"js-tag"});this.__tab._$setEvent("onchange",this.__onTabChange._$bind(this))};fj.__doSyncTab=function(U){var bl=B._$indexOf(this.__xlist,function(bP){return U.indexOf(bP.url)>=0});if(bl<0)return;this.__tab._$go(bl);var bc=this.__xlist[0];if(U.indexOf(bc.url)>=0)bc.umi=U};fj.__onTabChange=function(g){var bc=this.__xlist[g.index];bg.dispatcher._$redirect(bc.umi||bc.url)};fj.__onShow=function(g){this.__doSyncTab(g.href);lP.__onShow.apply(this,arguments)};fj.__onRefresh=function(g){this.__doSyncTab(g.href)};bg.dispatcher._$loaded("/m",z._$$ModuleM)})()</textarea> <textarea name="jst" id="a-jst-0"> <div class="w-tab2"> {list xlist as x} <a class="itm js-tag" href="#">${x.name}</a> {/list} </div> <div class="w-box2"></div> </textarea> <textarea name="css">.m-a .w-tab2{float:left;width:100px;margin-right:-100px;text-align:center;font-size:14px;}.m-a .w-tab2 .itm{display:block;height:30px;line-height:30px;margin-bottom:5px;color:#000;background:#ccc;}.m-a .w-tab2 .itm:hover{text-decoration:none;}.m-a .w-tab2 .js-selected{background:#888;color:#fff;font-weight:bold;}.m-a .w-box2{margin-left:100px;padding-left:10px;border-left:1px solid #888;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,eX,lo;z._$$ModuleA=NEJ.C();eX=z._$$ModuleA._$extend(bo._$$Module,!0);lo=z._$$ModuleA._$supro;eX.__doBuild=function(){this.__xlist=[{url:"/m/a/a0/",name:"A0"},{url:"/m/a/a1/",name:"A1"},{url:"/m/a/a2/",name:"A2"}];this.__body=q._$create("div","m-a");q._$renderHtmlTemplate(this.__body,"a-jst-0",{xlist:this.__xlist});var G=q._$getChildren(this.__body);this.__export.box=G[1];this.__tab=q._$tab(G[0],{clazz:"js-tag"});this.__tab._$setEvent("onchange",this.__onTabChange._$bind(this))};eX.__doSyncTab=function(U){var bl=B._$indexOf(this.__xlist,function(bP){return bP.url===U});if(bl<0)return;this.__tab._$go(bl)};eX.__onTabChange=function(g){bg.dispatcher._$redirect(this.__xlist[g.index].url)};eX.__onShow=function(g){this.__doSyncTab(g.href);lo.__onShow.apply(this,arguments)};eX.__onRefresh=function(g){this.__doSyncTab(g.href)};bg.dispatcher._$loaded("/m/a",z._$$ModuleA)})()</textarea>  </div> <script type="text/javascript">location.config = {"ver":{"index/a.a0.html":"33b4850a7d1dd4f355e37bd7b02be3f7","index/a.a1.html":"8d0ce35d26d4b6004e5118944a10ecac","index/a.a2.html":"bb8e5f1a3dc1fc7c0e2345ac6e2a0f7d","index/a.html":"d8cff47092d5fb12dd1b22dbbe3008b1","index/b.b0.html":"64067e5638fddf1d56cdd3998f164dcb","index/b.b1.html":"3521c5053904888e445fe2cbfd1a407d","index/b.b2.html":"610f0df60b04fb7987b54d3489a5576e","index/b.html":"7bc4fa94a28217eb209318adf89c424c","index/c.html":"66066b4875232d4168f377f3e265beda","index/d.d0.html":"e0ed23788dcb53e77e87245ee6d47a7f","index/d.d1.html":"e534d236633dcf221ee02429e9106de1","index/d.d2.html":"36f775fa47fee96f72b4e9279f432c8d","index/d.html":"76913a380b3dc02931c8849b678cccff","index/m.html":"bdceedf09eff3e05258c144128e37504","index/ui.html":"c331aeb1ed80a84ef0320a9a114b8a4d","index.html":"07512bd308161bb55a7022fc31f5ec17","simple.html":"f3c3792b2896ca277a36c93b1338073a","test/a.html":"7b52dd9dcc114f4d9f9a581a454368a9","test/b.html":"7b52dd9dcc114f4d9f9a581a454368a9"},"root":"./"};</script> <div style="display:none;" id="umi://index/a.a0.html"><meta charset="utf-8"/> <textarea name="ntp" id="a0-ntp-0"> <div class="m-a0"> <input type="button" value="send message to C"/> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> <p>0000000000000000000000</p> </div> </textarea> <textarea name="css">.m-a0{min-height:500px;_height:500px;background:#f00;}.m-a0 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,iZ,oI;z._$$ModuleA0=NEJ.C();iZ=z._$$ModuleA0._$extend(bo._$$Module,!0);oI=z._$$ModuleA0._$supro;iZ.__doBuild=function(){this.__body=q._$getNodeTemplate("a0-ntp-0");T._$addEvent(this.__body.getElementsByTagName("input")[0],"click",this.__doSendMessage._$bind(this))};iZ.__doSendMessage=function(){bg.dispatcher._$message({to:"/m/c/",from:this.__umi,data:"hello C! my name is a0."})};bg.dispatcher._$loaded("/m/a/a0/",z._$$ModuleA0)})()</textarea></div><div style="display:none;" id="umi://index/a.a1.html"><meta charset="utf-8"/> <textarea name="ntp" id="a1-ntp-0"> <div class="m-a1"> <input type="button" value="send message to C"/> <input type="button" value="send message to A0"/> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> <p>1111111111111111111111111111</p> </div> </textarea> <textarea name="css">.m-a1{min-height:500px;_height:500px;background:#fdc;}.m-a1 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,iV,oL;z._$$ModuleA1=NEJ.C();iV=z._$$ModuleA1._$extend(bo._$$Module,!0);oL=z._$$ModuleA1._$supro;iV.__doBuild=function(){this.__body=q._$getNodeTemplate("a1-ntp-0");var G=this.__body.getElementsByTagName("input");T._$addEvent(G[0],"click",this.__doSendMessage._$bind(this,"/m/c/"));T._$addEvent(G[1],"click",this.__doSendMessage._$bind(this,"/m/a/a0/"))};iV.__doSendMessage=function(cL){bg.dispatcher._$message({to:cL,from:this.__umi,data:"hello C! my name is a1."})};bg.dispatcher._$loaded("/m/a/a1/",z._$$ModuleA1)})()</textarea></div><div style="display:none;" id="umi://index/a.a2.html"><meta charset="utf-8"/> <textarea name="ntp" id="a2-ntp-0"> <div class="m-a2"> <input type="button" value="send message to C"/> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> <p>222222222222222222222222222</p> </div> </textarea> <textarea name="css">.m-a2{min-height:500px;_height:500px;background:#aaa;}.m-a2 input{padding:5px 10px;margin:10px 0;}</textarea><textarea name="js">(function(){var u=NEJ.P,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),bo=u("dm.ut"),z=NEJ.P("dm.m"),bg=window,iP,oO;z._$$ModuleA2=NEJ.C();iP=z._$$ModuleA2._$extend(bo._$$Module,!0);oO=z._$$ModuleA2._$supro;iP.__doBuild=function(){this.__body=q._$getNodeTemplate("a2-ntp-0");T._$addEvent(this.__body.getElementsByTagName("input")[0],"click",this.__doSendMessage._$bind(this))};iP.__doSendMessage=function(){bg.dispatcher._$message({to:"/m/c/",from:this.__umi,data:"hello C! my name is a2."})};bg.dispatcher._$loaded("/m/a/a2/",z._$$ModuleA2)})()</textarea></div><script src="../r/core.js?ecc7ad0ee93143ca31ee270f9c0d5278" type="text/javascript"></script><script type="text/javascript">(function(){var u=NEJ.P,bp=NEJ.O,B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ut.p"),cF;if(!!z._$$Node)return;z._$$Node=NEJ.C();cF=z._$$Node._$extend(bo._$$Event);cF.__init=function(){this.__supInit();this.__children=[]};cF.__reset=function(A){this.__supReset(A);this._$setParent(A.parent);this.__name=A.name||"/";this.__data=A.data||{}};cF.__destroy=function(){var gn=function(S,bl,G){G.splice(bl,1);S._$recycle()};return function(){this.__supDestroy();delete this.__data;B._$reverseEach(this.__children,gn);this._$setParent(null)}}();cF.__isNode=function(S){return S instanceof z._$$Node};cF.__hasChild=function(cA){return B._$indexOf(this.__children,cA)>=0};cF._$getName=function(){return this.__name};cF._$getData=function(){return this.__data};cF._$getPath=function(){var bi=this._$getParent(),I=this._$getName();if(!bi)return I;var fp=bi._$getName();if(fp!="/"&&I!="/")I="/"+I;return bi._$getPath()+I};cF._$getParent=function(){return this.__parent};cF._$getChildren=function(){return this.__children};cF._$getChildByName=function(I){var bl=B._$indexOf(this.__children,function(S){return I==S._$getName()});return this.__children[bl]||null};cF._$setParent=function(bi){bi=this.__isNode(bi)?bi:null;if(bi==this.__parent)return;!!bi?bi._$appendChild(this):this.__parent._$removeChild(this);this.__parent=bi;return this};cF._$appendChild=function(cA){cA=this.__isNode(cA)?cA:null;if(!cA||this.__hasChild(cA))return;this.__children.push(cA);cA._$setParent(this);return this};cF._$removeChild=function(cA){cA=this.__isNode(cA)?cA:null;var bl=B._$indexOf(this.__children,cA);if(bl>=0){this.__children.splice(bl,1);cA._$setParent(null)}return cA}})();
(function(){var u=NEJ.P,bw=NEJ.F,B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ut.p");var ml=function(bV,U,jW){var S=bV,jW=jW||bw;if(U!="/"){B._$forEach(U.split("/"),function(I){var bj=jW(S,I);if(!bj)return!0;S=bj})}return S};z._$getNodeByUMI=function(){var fQ=function(bi,I){var I=I||"/",fp=bi._$getName();if(fp=="/"&&I=="/")return bi;return bi._$getChildByName(I)};return function(bV,U){return ml(bV,U,fQ)}}();z._$appendNodeByUMI=function(){var qn=function(bi,I){var fp=bi._$getName();if(!I&&fp=="/")return bi;var S=null;if(fp!="/"){S=bi._$getChildByName("/");if(!S){S=z._$$Node._$allocate();bi._$appendChild(S)}}if(!!I){S=bi._$getChildByName(I);if(!S){S=z._$$Node._$allocate({name:I});bi._$appendChild(S)}}return S};return function(bV,U){return ml(bV,U,qn)}}();z._$getCommonRoot=function(bV,cy,bH){if(!cy||!bH)return bV;var cy=cy._$getPath().split("/"),bH=bH._$getPath().split("/"),qq=B._$forIn(cy,function(bf,bl){if(bf!=bH[bl])return!0})||1,U=cy.splice(0,qq).join("/")||"/";return z._$getNodeByUMI(bV,U)};z._$breadthFirstSearch=function(bV,bD){var bm=[bV],S=bm.shift(),bD=bD||bw;while(!!S){bm.push.apply(bm,S._$getChildren());bD(S);S=bm.shift()}return this};z._$isNode=function(S){return S instanceof z._$$Node};z._$isModule=function(bv){return bv instanceof bo._$$Module};z._$isUMIPrivate=function(){var by=/^\/?\?(?=\/|$)/;return function(U){return by.test(U||"")}}();z._$path2umi=function(){var by=/[\?#]/;return function(ba){var bm=(ba||"").trim().split(by),qx=bm[0]=="/"&&(bm[1]||"").indexOf("/")==0;return bm[0]+(qx?"?"+bm[1]:"")}}()})();
(function(){var u=NEJ.P,bp=NEJ.O,bg=u("nej.g"),q=u("nej.e"),bL=u("nej.j"),B=u("nej.u"),bo=u("nej.ut"),z=u("nej.ut.p"),cs;if(!!z._$$GroupManager)return;z._$$GroupManager=NEJ.C();cs=z._$$GroupManager._$extend(bo._$$Event);cs.__reset=function(A){this.__supReset(A);this.__root=A.root;this.__dispatcher=A.dispatcher;this.__mpool={}};cs.__destroy=function(){this.__supDestroy();delete this.__root;delete this.__mpool};cs.__isStopped=function(S){if(!z._$isNode(S))return!1;return!!S._$getData().stopped||this.__isStopped(S._$getParent())};cs.__doClearStopped=function(S){if(!z._$isNode(S))return;delete S._$getData().stopped;this.__doClearStopped(S._$getParent())};cs.__doModuleHide=function(bJ,cL){this.__doModuleCheck("onhide",bJ,cL)};cs.__doModuleShow=function(bJ,cL){this.__doModuleCheck("onshow",bJ,cL);this.__doModuleAction(bJ)};cs.__doModuleRefresh=function(S){this.__doModuleCheck("onrefresh",S);this.__doModuleAction(S)};cs.__doModuleCheck=function(N,bJ,cL){if(bJ==cL||!z._$isNode(bJ))return;if(N=="onhide")this.__doModuleDispatch(bJ,N);this.__doModuleCheck(N,bJ._$getParent(),cL);if(N!="onhide")this.__doModuleDispatch(bJ,N)};cs.__doModuleAction=function(S){if(!z._$isNode(S))return!0;var Y=S._$getData(),kf=Y.action,bv=Y.module;if(!this.__doModuleAction(S._$getParent())||!!kf&&B._$isString(bv))return!1;if(!!bv&&!!bv._$allocate&&!!kf&&kf!="onhide"){if(this.__isStopped(S))return;var A={umi:S._$getPath(),composite:Y.composite,dispatcher:this.__dispatcher};bv=bv._$allocate(A);if(z._$isModule(bv)){Y.module=bv;this.__doModuleDispatch(S,"onshow")}else{delete Y.module}}delete Y.action;return!0};cs.__doModuleDispatch=function(){var qL=function(S){var bv;S=S._$getParent();while(!!S){bv=S._$getData().module;if(z._$isModule(bv)){return bv._$getExportData()}S=S._$getParent()}return null};return function(S,I){if(!z._$isNode(S))return;var Y=S._$getData(),bv=Y.module,jU=I!="onhide";if(z._$isModule(bv)){if(jU&&this.__isStopped(S))return;var g=!this.__source?Y.event:this.__source._$getData().event;if(!!g){g.umi=S._$getPath();g.data=qL(S)}var mJ=Y.xname||"onhide";if(I=="onshow"&&mJ!="onhide")I="onrefresh";if(I=="onrefresh"&&mJ=="onhide")I="onshow";Y.xname=I;bv._$dispatchEvent(I,g||{});if(jU&&!!g&&!!g.pos&&g.umi==g.target){q._$scrollTo(g.pos)}if(jU&&!!g){Y.stopped=g.stopped;delete g.stopped}}else if(!!bv){Y.action=I;if(I=="onshow"&&B._$isString(bv)){var j=q._$get("umi://"+bv);if(!!j){q._$parseTemplate(j)}else{var bc=location.config||bp;bL._$loadHtml((bc.root||"")+bv,{version:(bc.ver||bp)[bv],onloaded:q._$parseTemplate})}}}}}();cs._$hasUMI=function(U){return!!this.__mpool[U]};cs._$addUMI=function(U){this.__mpool[U]=!0;return this};cs._$delUMI=function(U){delete this.__mpool[U];return this};cs._$loadedUMI=function(U){if(this._$hasUMI(U))this.__doModuleAction(z._$getNodeByUMI(this.__root,U));return this};cs._$dispatchUMI=function(U){if(this._$hasUMI(U)){var S=z._$getNodeByUMI(this.__root,U);this.__doClearStopped(S);this.__doModuleShow(S)}return this};cs._$hideUMI=function(U){if(this._$hasUMI(U)){this.__doModuleHide(z._$getNodeByUMI(this.__root,U))}return this}})();
(function(){var u=NEJ.P,bp=NEJ.O,bw=NEJ.F,q=u("nej.e"),z=u("nej.ut.p"),ea;if(!!z._$$SingleGroupManager)return;z._$$SingleGroupManager=NEJ.C();ea=z._$$SingleGroupManager._$extend(z._$$GroupManager);ea.__reset=function(A){this.__supReset(A);this.__classed=!!A.classed};ea.__destroy=function(){this.__supDestroy();delete this.__cmroot;delete this.__source};ea._$exitable=function(g){if(!this.__source)return!0;var bv=this.__source._$getData().module;if(z._$isModule(bv))bv._$dispatchEvent("onbeforehide",g);return!g.stopped};ea._$refresh=function(){if(!this.__source)return;window.setTimeout(this._$dispatchUMI._$bind(this,this.__source._$getPath()),0)};ea._$dispatchUMI=function(U){if(!this._$hasUMI(U))return this;var bH=z._$getNodeByUMI(this.__root,U),Y=bH._$getData();if(!Y.module)return this;var cy=this.__source,g=Y.event,iU=bp;this.__source=bH;this.__doClearStopped(bH);if(!!cy){iU=cy._$getData().event;g.referer=iU.href||""}if(cy==bH){this.__doModuleRefresh(this.__source);return this}this.__cmroot=z._$getCommonRoot(this.__root,cy,bH);if(cy!=null){if(cy!=this.__cmroot){if(this.__classed)q._$delClassName(document.body,iU.clazz);this.__doModuleHide(cy,this.__cmroot)}this.__doModuleRefresh(this.__cmroot)}else{this.__doModuleShow(this.__cmroot)}if(bH!=this.__cmroot){if(this.__classed)q._$addClassName(document.body,g.clazz);this.__doModuleShow(bH,this.__cmroot)}return this};ea._$loadedUMI=function(U){if(this._$hasUMI(U))this.__doModuleAction(this.__source);return this};ea._$hideUMI=bw})();
(function(){var u=NEJ.P,T=u("nej.v"),B=u("nej.u"),fE=u("nej.p"),D=u("nej.h"),bo=u("nej.ut"),dc=/^[#?]+/,fC=/#(.*?)$/,dJ=window,ko=!history.pushState||fE._$IS.android||!history.auto;var gX=function(ba,hH){dJ.history[!hH?"pushState":"replaceState"](null,document.title,ba)};var gu=function(){return location.parse(dJ.location.href)};gX=gX._$aop(function(g){if(!ko)return;var E=g.args;g.stopped=!0;ba=E[0].replace(dc,"");!E[1]?dJ.location.hash=ba:dJ.location.replace("#"+ba)});gu=gu._$aop(function(g){if(!ko)return;g.stopped=!0;var dX=fC.test(dJ.location.href)?RegExp.$1:"";g.value=location.parse(dX.replace(dc,""))});location.redirect=function(ba,hH){gX(ba,hH);return this};location.active=function(){var eN,ba,bR,jH,mr;var hF=function(hJ){if(!!jH){jH=!1;return}var g={oldValue:bR,newValue:gu()};if(!!location.ignored){location.ignored=!1}else{T._$dispatchEvent(location,"beforeurlchange",g);if(g.stopped){if(!!bR){jH=!0;gX(bR.href,!0)}return}}ba=dJ.location.href;bR=g.newValue;T._$dispatchEvent(location,"urlchange",bR);D.__pushHistory(bR.href)};var lR=function(){if(ba!=dJ.location.href)hF();eN=requestAnimationFrame(lR)};return function(el){if(!!mr)return this;mr=!0;dJ=el||window;if(ko&&"onhashchange"in window&&fE._$NOT_PATCH.trident2){T._$addEvent(dJ,"hashchange",hF);hF()}else if(!eN){eN=requestAnimationFrame(lR)}return this}}();location.parse=function(){var cz=/^https?:\/\/.*?\//i,dc=/[?#]/;return function(ba){var bj={href:ba};ba=(ba||"").replace(cz,"/").split(dc);var dn=1;if(ba[0]=="/"&&(ba[1]||"").indexOf("/")==0)dn=2;bj.path=ba.splice(0,dn).join("?");bj.query=B._$query2object(ba.join("&"));return bj}}();location.same=function(ba){return gu().href==ba};bo._$$CustomEvent._$allocate({element:location,event:["beforeurlchange","urlchange"]})})();
(function(){var u=NEJ.P,bp=NEJ.O,bw=NEJ.F,q=u("nej.e"),T=u("nej.v"),B=u("nej.u"),z=u("nej.ut"),cZ=u("nej.ut.p"),bO;if(!!z._$$Dispatcher)return;z._$$Dispatcher=NEJ.C();bO=z._$$Dispatcher._$extend(z._$$Event);bO.__init=function(){this.__supInit();var bE=+(new Date);this.__pbseed="pb-"+bE;this.__pvseed="pv-"+bE};bO.__reset=function(A){this.__dtmp={};this.__rest=!!A.rest;this.__root=cZ._$$Node._$allocate();this.__config={m:{},mg:{},r:[],rr:{},al:{}};this.__groups={};this.__doBuildGroup(this.__pbseed);this.__groups[this.__pvseed]=cZ._$$GroupManager._$allocate({root:this.__root,dispatcher:this});this.__doInitDomEvent([[location,"urlchange",this.__onURLChange._$bind(this)]]);this.__supReset(A);this._$rule(A.rules);this._$regist(A.modules)};bO.__destroy=function(){var gn=function(dh,W,bb){delete bb[W];dh._$recycle()};return function(){delete this.__config;this.__root=this.__root._$recycle();B._$forIn(this.__groups,gn);this.__supDestroy()}}();bO.__setModuleConf=function(U,W,bf){var eK=this.__config.m[U];if(!eK){eK={};this.__config.m[U]=eK}eK[W]=bf};bO.__getModuleConf=function(U,W){var eK=this.__config.m[U];return!eK?"":eK[W]};bO.__doBuildGroup=function(bN){if(!bN)return;var dh=this.__groups[bN];if(!dh){dh=cZ._$$SingleGroupManager._$allocate({root:this.__root,dispatcher:this,classed:bN==this.__pbseed});this.__groups[bN]=dh}return dh};bO.__doAddUMI2Group=function(U,bN){var dh=this.__doBuildGroup(bN);if(!dh){bN=cZ._$isUMIPrivate(U)?this.__pvseed:this.__pbseed;dh=this.__groups[bN]}dh._$addUMI(U);this.__config.mg[U]=bN};bO.__doRewriteUMI=function(){var by=/\$\d/;return function(U,hJ){var bj;B._$forIn(this.__config.r,function(bc){B._$forIn(bc,function(bf,W){if(!!bf.test&&(bf.test(U)||bf.test(hJ))){bj=by.test(W)?U.replace(bf,W):W;return!0}if(bf===U||bf===hJ){bj=W;return!0}});return!!bj});return bj||U}}();bO.__onURLChange=function(){var fl=/(?:^\/+)|(?:\/+$)/gi,cz=/#(\$.*?)$/;var qD=function(U,S){var fd=S._$getPath(),U=U.replace(fd,"").replace(fl,"");return U.split("/")};var kZ=function(U,bb){var bf,bm=U.split("/");while(bm.length>0){if(!bm[bm.length-1]){bm.pop()}else{bm[bm.length-1]=""}bf=bb[bm.join("/")];if(!!bf)return bf}return""};return function(bR){if(bR.path.indexOf("$")==0)return;var oN=this.__dtmp[bR.path];delete this.__dtmp[bR.path];this._$dispatchEvent("onbeforechange",bR);var U=this.__doRewriteUMI(bR.path,bR.href),bN=this.__config.mg[U];if(!bN&&this.__rest)bN=kZ(U,this.__config.mg);if(!bN&&!cZ._$isUMIPrivate(U)){U=this.__config.rr["404"];bN=this.__config.mg[U]}if(!bN&&this.__rest)bN=kZ(U,this.__config.mg);if(!bN)return;var S=cZ._$getNodeByUMI(this.__root,U),lj=null;if(this.__rest)lj=qD(U,S);var cy=U;U=S._$getPath();S._$getData().event={target:U,source:cy,href:bR.href,param:bR.query,input:oN,prest:lj,clazz:this.__getModuleConf(U,"clazz"),pos:cz.test(bR.href)?RegExp.$1:""};var hc=this.__getModuleConf(cy,"title");if(!!hc)document.title=hc;this.__groups[bN]._$dispatchUMI(U)}}();bO.__onClickDelegate=function(){var pV=function(S){return!!q._$dataset(S,"href")};return function(g){var j=T._$getElement(g,pV);if(!!j){T._$stopDefault(g);this._$redirect(q._$dataset(j,"href"))}}}();bO._$rule=function(){var pR=["404"];var pJ=function(bc,W){this._$rule(W,bc)};var pv=function(hc,U){this.__setModuleConf(U,"title",hc)};var oS=function(U,oP){this.__config.al[oP]=U};var lL=function(bc){if(!bc)return;this.__config.r.push(bc);B._$forEach(pR,function(W){if(!bc[W])return;this.__config.rr[W]=bc[W];delete bc[W]},this)};var gM={title:function(bc){B._$forIn(bc,pv,this)},rewrite:function(bc){if(!B._$isArray(bc)){lL.call(this,bc)}else{B._$forEach(bc,lL,this)}},alias:function(bc){B._$forIn(bc,oS,this)}};return function(W,bc){if(B._$isArray(W)){bc=W;W="rewrite"}else if(!B._$isString(W)){B._$forIn(W,pJ,this);return this}(gM[W]||bw).call(this,bc);return this}}();bO._$regist=function(){var pY=function(bc,U){this._$regist(U,bc)};var mk=function(bv){return!!bv&&!!bv._$extend};return function(U,bc){if(!B._$isString(U)){B._$forIn(U,pY,this);return this}var Y=cZ._$appendNodeByUMI(this.__root,U)._$getData(),bv=Y.module;if(cZ._$isModule(bv)||mk(bv))return this;var bN=this.__config.mg[U],bv;if(B._$isString(bc)||mk(bc)){bv=bc}else{bc=bc||bp;bN=bc.gid;bv=bc.module;if(!!bc.title)this.__setModuleConf(U,"title",bc.title);if(!!bc.clazz)this.__setModuleConf(U,"clazz",bc.clazz);if(!!bc.composite)Y.composite=bc.composite}this.__doAddUMI2Group(U,bN);Y.module=bv;return this}}();bO._$message=function(){var hP=function(S,bY){var bv=S._$getData().module;if(cZ._$isModule(bv))bv._$dispatchEvent("onmessage",bY)};var gM=[hP,function(bH,bY){var bJ=bY.from;while(!!bH){if(bH._$getPath()!=bJ)hP(bH,bY);bH=bH._$getParent()}},function(bH,bY){var bJ=bY.from;cZ._$breadthFirstSearch(bH,function(S){if(S._$getPath()!=bJ)hP(S,bY)})}];return function(bY){var g=NEJ.X({},bY),bH=cZ._$getNodeByUMI(this.__root,g.to);g.path=bH._$getPath();(gM[g.mode]||gM[0]).call(this,bH,g)}}();bO._$publish=function(N,bY){var bY=NEJ.X({},bY);bY.type=N||"";this._$dispatchEvent((bY.from||"")+":"+bY.type,bY)};bO._$subscribe=function(U,N,cf){U=this.__config.al[U]||U;this._$pushEvent((U||"")+":"+(N||""),cf)};bO._$unsubscribe=function(U,N,cf){U=this.__config.al[U]||U;this._$delEvent((U||"")+":"+(N||""),cf)};bO._$apply=function(ba){return this._$redirect(ba)};bO._$hide=function(U){var bN=this.__config.mg[U];if(bN==this.__pvseed){this.__groups[bN]._$hideUMI(U)}return this};bO._$redirect=function(ba,A){A=A||bp;var U=cZ._$path2umi(ba),bR=location.parse(ba);this.__dtmp[bR.path]=A.input;if(cZ._$isUMIPrivate(U)){this.__onURLChange(bR)}else{var dh=this.__groups[this.__pbseed],g={target:bR,umi:U};if(!!dh._$exitable(g)){if(location.same(ba)&&!!A.force){this.__onURLChange(bR)}else{location.ignored=!!A.ignored;location.redirect(ba,!!A.replace)}}}return this};bO._$refresh=function(ba){if(!!ba){this._$redirect(ba,{replace:!0,force:!0})}else{this.__groups[this.__pbseed]._$refresh()}};bO._$delegate=function(){this.__doInitDomEvent([[document,"click",this.__onClickDelegate._$bind(this)]]);return this};bO._$active=function(){location.active();return this};bO._$loaded=function(U,bv){U=this.__config.al[U]||U;if(!B._$isArray(U)){this._$regist(U,bv);this.__groups[this.__config.mg[U]]._$loadedUMI(U)}else{B._$forEach(U,function(W){this._$loaded(W,bv)},this)}return this};q._$startup=function(A){window.dispatcher=z._$$Dispatcher._$getInstance(A);q._$parseTemplate((A||bp).tid||"template-box");T._$addEvent(document,"templateready",function(){dispatcher._$active()});return window.dispatcher}})();
(function(){var u=NEJ.P,q=u("nej.e"),bo=u("nej.ut");window.dispatcher=bo._$$Dispatcher._$getInstance({rules:{rewrite:{404:"/m/a/a0/","/m/a/a0/":"/"},title:{"/m/b/":"Module B","/m/c/":"Module C"}},modules:{"/":"index/ui.html","/m":"index/m.html","/m/a":"index/a.html","/m/b/":"index/b.html","/m/c/":"index/c.html","/m/d/":"index/d.html","/m/a/a0/":{module:"index/a.a0.html",title:"Module A-A0",clazz:"g-aa0"},"/m/a/a1/":{module:"index/a.a1.html",title:"Module A-A1",clazz:"g-aa1"},"/m/a/a2/":{module:"index/a.a2.html",title:"Module A-A2",clazz:"g-aa2"},"/?/b/b0/":"index/b.b0.html","/?/b/b1/":"index/b.b1.html","/?/b/b2/":"index/b.b2.html","/?/d/d0/":{module:"index/d.d0.html",title:"Module D-D0",gid:"d"},"/?/d/d1/":{module:"index/d.d1.html",title:"Module D-D1",gid:"d"},"/?/d/d2/":{module:"index/d.d2.html",title:"Module D-D2",gid:"d"}}});q._$parseTemplate("template-box");dispatcher._$active()})()</script> </body> </html>